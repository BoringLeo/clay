<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="shortcut icon" href="../../doc/images/clay.png" type="image/x-png">
    <script src="../libs/clay.js"></script>
    <script src="../../data/geoJSON/china.json.js"></script>
    <title>中国地图</title>
    <script>
        $$(function () {

            // 由于默认参数就是绘制中国地图的最佳参数
            // 不需要调整
            var map = clay.math.map.polar();

            $$('<svg></svg>').appendTo('body')
                .attr("width", 2000)
                .attr("height", 2000);

            var colors = $$.getColors(chinaMapData.features.length);

            function createImg(index, points) {
                temp = map(points[0][0], points[0][1]);

                result = "M" + (1000 + temp[0]) + "," + (temp[1] + 1000);
                for (flag = 1; flag < points.length; flag++) {
                    temp = map(points[flag][0], points[flag][1]);
                    result += "L" + (1000 + temp[0]) + "," + (temp[1] + 1000);
                }
                $$('<path fill=' + colors[index] + ' d=' + result + '></path>').appendTo($$('g').eq(index));
            };

            $$('svg').find('g').data(chinaMapData.features).enter('g').appendTo('svg').refresh()

                // 绘制地图
                .attr('name', function (data, index) {

                    var flag, points = data.geometry.coordinates, temp, result;
                    if (typeof points[0][0][0] === 'number') {
                        createImg(index, points[0]);
                    } else {
                        for (flag = 0; flag < points[0].length; flag++) {
                            createImg(index, points[0][flag]);
                        }
                    }

                    return data.properties.name;

                });

        });
    </script>
</head>

<body></body>

</html>
