<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <title>clay - 使用测试 - tree.canvas</title>
    <script src="../libs/clay.js"></script>
    <script>

        $$(function () {

            var tree = clay.layout.tree();

            var pen = $$('canvas')[0].getContext("2d");

            var
                nodeDrawer = function (node) {
                    pen.beginPath();
                    pen.arc(node.left * 150, node.top * 50, 10, 0, Math.PI * 2);
                    pen.closePath();
                    pen.fill();
                    pen.fillText(node.data.name, node.left * 150, node.top * 50 + 20);
                },
                linkDrawer = function (pNode, node) {
                    pen.beginPath();
                    pen.moveTo(pNode.left * 150, pNode.top * 50);
                    pen.bezierCurveTo(
                        pNode.left * 150 + 100, pNode.top * 50,
                        node.left * 150 - 100, node.top * 50,
                        node.left * 150, node.top * 50
                    );
                    pen.stroke();
                };

            tree
                .bind('root', function (initTree) {
                    return initTree;
                })
                .bind('child', function (parentTree) {
                    return parentTree.list;
                })
                .bind('id', function (treedata) {
                    return treedata.name;
                })
                .bind('live', function () {
                    pen.clearRect(0, 0, 1000, 700);
                })
                .bind('drawer', nodeDrawer, linkDrawer);

            // 初始化树
            tree({
                "name": "前端",
                "list": [{
                    "name": "核心",
                    "list": [{
                        "name": "HTML"
                    }, {
                        "name": "CSS"
                    }, {
                        "name": "ES"
                    }, {
                        "name": "计算机",
                        "list": [{
                            "name": "算法",
                            "list": [{
                                "name": "思想",
                                "list": [{
                                    "name": "分治"
                                }, {
                                    "name": "回溯"
                                }, {
                                    "name": "限界"
                                }, {
                                    "name": "贪心"
                                }]
                            }, {
                                "name": "模式"
                            }]
                        }]
                    },]
                }, {
                    "name": "安全"
                }, {
                    "name": "工具"
                }, {
                    "name": "规范"
                }, {
                    "name": "库"
                }]
            });

        });

    </script>
</head>

<body>

    <canvas width=1000 height=700></canvas>

</body>

</html>
