/*!
*
* clay - Provide more flexible data visualization solutions!
* git+https://github.com/yelloxing/clay.git
* 
* author 心叶
*
* version 1.2.4
* 
* build Sun Jul 29 2018
*
* Copyright yelloxing
* Released under the MIT license
* 
* Date:Wed Oct 24 2018 22:16:51 GMT+0800 (中国标准时间)
*/

!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e(t):e(t)}("undefined"!=typeof window?window:this,function(t,f){"use strict";var o,y=function(t,e){return new y.prototype.init(t,e)};y.prototype.init=function(e,t){if("function"==typeof e)o?e():document.addEventListener?document.addEventListener("DOMContentLoaded",function t(){document.removeEventListener("DOMContentLoaded",t,!1),e(),o=!0}):document.attachEvent&&document.attachEvent("onreadystatechange",function t(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",t),e(),o=!0)});else{this.context=t=t||document;var n,r=u(e,t);for(n=0;n<r.length;n++)this[n]=r[n];this.selector=e,this.length=r.length}return this},y.prototype.extend=y.extend=function(){var t=arguments[0]||{},e=arguments[1]||{},n=arguments.length;for(var r in 1===n&&(e=t,t=this),"object"!=typeof t&&"function"!=typeof t&&(t={}),e)t[r]&&console.warn("Extension may lead to coverage！"),t[r]=e[r];return t},y.prototype.init.prototype=y.prototype;var i={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},v={whitespace:"[\\x20\\t\\r\\n\\f]",identifier:"(?:\\\\.|[\\w-]|[^\0-\\xa0])+"};y.math={},y.physics={},y.scale={},y.svg={},y.canvas={},y.layout={};var a=["href","title","show","type","role","actuate"],x=[{R:6317e3}],E=9e8;function u(t,e){var n,r=[];if("string"!=typeof t){if(!t||1!==t.nodeType&&11!==t.nodeType&&9!==t.nodeType){if(!t||t.constructor!==Array&&t.constructor!==HTMLCollection&&t.constructor!==NodeList)return t&&t.constructor===y?t:[];for(n=0;n<t.length;n++)!t[n]||1!==t[n].nodeType&&11!==t[n].nodeType&&9!==t[n].nodeType||r.push(t[n]);return r}return[t]}if("*"===(t=(t+"").trim().replace(/[\n\f\r]/g,"")))return e.getElementsByTagName("*");var o=v.whitespace,i=v.identifier,a="\\["+o+"{0,}"+i+"(?:"+o+"{0,}="+o+"{0,}(\\'|\\\"){0,1}"+i+"\\1{0,1}){0,1}"+o+"{0,}\\]";if(new RegExp("^(?:"+i+"){0,1}(?:(?:#|\\.)"+i+"|"+a+"){0,}$").test(t)){var u,c=t.match(new RegExp("#"+i,"g")),s=t.match(new RegExp("\\."+i,"g")),f=t.match(new RegExp("^"+i)),l=t.match(new RegExp(a,"g"));if(c){if(1<c.length)return[];u=(u=document.getElementById((c.shift(0)+"").replace(/^#/,"")))?[u]:[]}else u=e.getElementsByClassName&&s?e.getElementsByClassName((s.shift(0)+"").replace(/^\./,"")):f?e.getElementsByTagName(f.shift(0)):e.getElementsByTagName("*");var h,p,d,g,m=new RegExp("^\\["+o+"{0,}("+i+")(?:"+o+"{0,}="+o+"{0,}(?:\\'|\\\"){0,1}("+i+")(?:\\'|\\\"){0,1}){0,1}"+o+"{0,}\\]$");for(n=0;n<u.length;n++)if(g=!0,!(f&&0<f.length&&(f[0]+"").toUpperCase()!==(u[n].tagName+"").toUpperCase())){for(h=" "+u[n].getAttribute("class")+" ",p=0;g&&s&&p<s.length;p++)if(h.search(" "+(s[p]+"").replace(/\./,"")+" ")<0){g=!1;break}for(p=0;g&&l&&p<l.length;p++)if(h=m.exec(l[p]),null===(d=u[n].getAttribute(h[1]))||h[2]&&d!=h[2]){g=!1;break}g&&r.push(u[n])}return r}try{return[b(t)]}catch(t){return[]}}function b(t){var e=document.createElementNS(i.svg,"svg");new RegExp("^"+v.identifier+"$").test(t)&&(t="<"+t+"></"+t+">"),e.innerHTML=t;var n,r,o=e.childNodes;for(n=0;n<o.length;n++)if(1===o[n].nodeType||9===o[n].nodeType||11===o[n].nodeType){r=o[n];break}if("canvas"==r.tagName||/[A-Z]/.test(r.tagName))for((e=document.createElement("div")).innerHTML=t,o=e.childNodes,n=0;n<o.length;n++)if(1===o[n].nodeType||9===o[n].nodeType||11===o[n].nodeType){r=o[n];break}return r}y.prototype.find=function(t){if(this.length<=0)return y();var e,n=y(),r=u(t,this[0]);for(n.selector=t,e=0;e<r.length;e++)n[e]=r[e],n.length+=1;return n},y.prototype.eq=function(t){return this.length<=t?new y:new y(this[t])},y.prototype.appendTo=function(t){var e,n,r=y(t);for(e=0;e<r.length;e++)for(n=0;n<this.length;n++)r[e].appendChild(this[n]);return this},y.prototype.remove=function(){var t;for(t=0;t<this.length;t++)this[t].parentNode.removeChild(this[t]);return this},y.prototype.refresh=function(){var t,e=u(this.selector,this.context),n=this.length;for(t=this.length=0;t<e.length;t++)this[t]=e[t],this.length+=1;for(;t<n;t++)delete this[t];return this},y.prototype.attr=function(t,e){if(null==e||e==f)return 0<this.length?this[0].getAttribute(t):f;var n,r;for(n=0;n<this.length;n++)r="function"==typeof e?e(this[n]._data,n,this.eq(n)):e,/[A-Z]/.test(this[n].tagName)&&0<=a.indexOf(t)?this[n].setAttributeNS(i.xlink,"xlink:"+t,r):this[n].setAttribute(t,r);return this},y.prototype.css=function(t,e){if(arguments.length<=1&&"object"!=typeof t){if(this.length<1)return f;var n=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(this[0],null):this[0].currentStyle;return"string"==typeof t?n.getPropertyValue(t):n}var r,o;if(0<this.length)if("object"==typeof t)for(o in t)for(r=0;r<this.length;r++)this[r].style[o]="function"==typeof e?e(this[r]._data,r,o,t[o]):t[o];else for(r=0;r<this.length;r++)this[r].style[t]="function"==typeof e?e(this[r]._data,r):e;return this},y.prototype.datum=function(t,e){if(null===t||t===f)return 0<this.length?this[0]._data:f;var n;for(t="function"==typeof e?e(t):t,n=0;n<this.length;n++)this[n]._data=t;return this},y.prototype.data=function(t,e){var n,r=[];if(t&&t.constructor===Array){var o=y();for(o.selector=this.selector,n=0;n<t.length&&n<this.length;n++)this[n]._data="function"==typeof e?e(t[n]):t[n],o[n]=this[n],o.length+=1;for(o._enter=[];n<t.length;n++)o._enter.push("function"==typeof e?e(t[n]):t[n]);for(o._exit=[];n<this.length;n++)o._exit.push(this[n]);return o}for(n=0;n<this.length;n++)r[n]=this[n]._data;return r},y.prototype.enter=function(t){var e,n,r=y();for(r.selector=this.selector,e=0;this._enter&&e<this._enter.length;e++)(n=b(t))._data=this._enter[e],r[e]=n,r.length+=1;return delete this._enter,r},y.prototype.exit=function(){var t,e=y();for(e.selector=this.selector,t=0;this._exit&&t<this._exit.length;t++)e[t]=this._exit[t],e.length+=1;return delete this._exit,e},y.prototype.bind=function(t,e){var n;if(window.attachEvent)for(n=0;n<this.length;n++)this[n].attachEvent("on"+t,e);else for(n=0;n<this.length;n++)this[n].addEventListener(t,e,!1);return this},y.prototype.unbind=function(t,e){var n;if(window.detachEvent)for(n=0;n<this.length;n++)this[n].detachEvent("on"+t,e);else for(n=0;n<this.length;n++)this[n].removeEventListener(t,e,!1);return this},y.prototype.position=function(t){var e=this[0].getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}};var l=function(t,e,n,r){switch(t.beginPath(),t.fillStyle=e,n){case"rectangle":t.moveTo(r[0],r[1]),t.lineTo(r[0]+r[2],r[1]),t.lineTo(r[0]+r[2],r[1]+r[3]),t.lineTo(r[0],r[1]+r[3]);break;case"round":t.moveTo(r[0]+r[2],r[1]),t.arc(r[0],r[1],r[2],0,2*Math.PI);break;case"polygon":var o;for(t.moveTo(r[0][0],r[0][1]),o=1;o<r.length;o++)t.lineTo(r[o][0],r[o][1]);break;default:n(t)}t.fill()};y.region=function(t,e,n){var o={},r=document.createElement("canvas"),i=[0,0,0],a="r";r.setAttribute("width",e),r.setAttribute("height",n);var u=y(t),c=r.getContext("2d"),s={drawer:function(t,e,n){return o[t]==f&&(o[t]={r:function(){return i[0]+=1,a="g","rgb("+i[0]+","+i[1]+","+i[2]+")"},g:function(){return i[1]+=1,a="b","rgb("+i[0]+","+i[1]+","+i[2]+")"},b:function(){return i[2]+=1,a="r","rgb("+i[0]+","+i[1]+","+i[2]+")"}}[a]()),l(c,o[t],e,n),s},erase:function(t,e){return l(c,"rgb(0,0,0)",t,e),s},getRegion:function(t){var e,n=u.position(t),r=c.getImageData(n.x-.5,n.y-.5,1,1).data;for(e in o)if("rgb("+r[0]+","+r[1]+","+r[2]+")"==o[e])return e;return f}};return s};var c={timers:[],interval:13,speeds:400,timerId:null};y.animation=function(e,t,n){c.timer(function(t){e(t)},t,n)},c.timer=function(t,e,n){if("function"!=typeof t)throw new Error("tick is required!");(e="number"==typeof e?e:c.speeds)<0&&(e=-e),c.timers.push({createTime:new Date,tick:t,duration:e,callback:n}),c.start()},c.start=function(){c.timerId||(c.timerId=setInterval(c.tick,c.interval))},c.tick=function(){var t,e,n,r,o,i,a,u=c.timers;for(c.timers=[],e=c.timers.length=0;e<u.length;e++)t=(o=u[e]).createTime,n=o.tick,i=o.duration,r=o.callback,!1,1<=(a=(+new Date-t)/i)&&!0,n(a=1<a?1:a),a<1?c.timers.push(o):r&&r();c.timers.length<=0&&c.stop()},c.stop=function(){c.timerId&&(clearInterval(c.timerId),c.timerId=null)},y.color=function(t){var e=y("head").css("color",t).css("color").replace(/^rgba?\(([^)]+)\)$/,"$1").split(new RegExp("\\,"+v.whitespace));return[+e[0],+e[1],+e[2],e[3]==f?1:+e[3]]},y.getColors=function(t){if("number"==typeof t&&3<t){var e=[],n=0;for(n=1;n<=t;n++)e.push("rgb("+(230*Math.random(1)+20).toFixed(0)+","+(230*Math.random(1)+20).toFixed(0)+","+(230*Math.random(1)+20).toFixed(0)+")");return e}return["rgb(255,0,0)","rgb(0,255,0)","rgb(0,0,255)"]},y.max=function(t,e){e="function"==typeof e?e:function(t){return t};for(var n,r=1,o=t[0],i=e(t[0],0);r<t.length;r++)i<(n=e(t[r],r))&&(o=t[r],i=n);return o},y.min=function(t,e){e="function"==typeof e?e:function(t){return t};for(var n,r=1,o=t[0],i=e(t[0],0);r<t.length;r++)(n=e(t[r],r))<i&&(o=t[r],i=n);return o},y.loop=function(t,e){var n,r=0;for(n in t)e(t[n],r,n),r+=1;return y},y.math.hermite=function(){var c={u:.5},s=function(t){if(c.MR){var e=(t-c.a)/(c.b-c.a),n=e*e;return(e*n*c.MR[0]+n*c.MR[1]+e*c.MR[2]+c.MR[3])*(c.b-c.a)}throw new Error("You shoud first set the position!")};return s.setU=function(t){if("number"!=typeof t)throw new Error("Expecting a figure!");return c.u=.5*(1-t),s},s.setP=function(t,e,n,r,o,i){if(!(t<n))throw new Error("The point position should be increamented!");c.a=t,c.b=n;var a=c.u*o,u=c.u*i;return e/=n-t,r/=n-t,c.MR=[2*e-2*r+a+u,3*r-3*e-2*a-u,a,e],s},s},y.math.cardinal=function(){var e,o={t:0},i=function(t){if(o.hs){for(e=-1;e+1<o.hs.x.length&&(t>o.hs.x[e+1]||-1==e&&t>=o.hs.x[e+1]);)e+=1;if(-1==e||e>=o.hs.h.length)throw new Error("Coordinate crossing!");return o.hs.h[e](t)}throw new Error("You shoud first set the position!")};return i.setU=function(t){if("number"!=typeof t)throw new Error("Expecting a figure!");return o.t=t,i},i.setP=function(t){o.hs={x:[],h:[]};var e,n,r=(t[1][1]-t[0][1])/(t[1][0]-t[0][0]);for(o.hs.x[0]=t[0][0],e=1;e<t.length;e++){if(t[e][0]<=t[e-1][0])throw new Error("The point position should be increamented!");o.hs.x[e]=t[e][0],n=e<t.length-1?(t[e+1][1]-t[e-1][1])/(t[e+1][0]-t[e-1][0]):(t[e][1]-t[e-1][1])/(t[e][0]-t[e-1][0]),o.hs.h[e-1]=y.math.hermite().setU(o.t).setP(t[e-1][0],t[e-1][1],t[e][0],t[e][1],r,n),r=n}return i},i},y.math.rotate=function(){var d={},g=function(t,e){if(d.M&&d.P){var n=d.M.A[0][0]*d.P[0]+d.M.A[0][1]*d.P[1]+d.M.A[0][2]*d.P[2]+d.M.A[0][3],r=d.M.A[1][0]*d.P[0]+d.M.A[1][1]*d.P[1]+d.M.A[1][2]*d.P[2]+d.M.A[1][3],o=d.M.A[2][0]*d.P[0]+d.M.A[2][1]*d.P[1]+d.M.A[2][2]*d.P[2]+d.M.A[2][3],i=Math.cos(t),a=Math.sin(t),u=n*i-r*a;r=n*a+r*i,n=u;var c=[d.M.B[0][0]*n+d.M.B[0][1]*r+d.M.B[0][2]*o+d.M.B[0][3],d.M.B[1][0]*n+d.M.B[1][1]*r+d.M.B[1][2]*o+d.M.B[1][3],d.M.B[2][0]*n+d.M.B[2][1]*r+d.M.B[2][2]*o+d.M.B[2][3]];return c[0]=Math.round(1e14*c[0])/1e14,c[1]=Math.round(1e14*c[1])/1e14,c[2]=Math.round(1e14*c[2])/1e14,e&&(d.P=c),c}throw new Error("You shoud first set the ray and position!")};return g.setL=function(t,e,n,r,o,i){if("number"!=typeof t||"number"!=typeof e)throw new Error("a1 and b1 is required!");if("number"!=typeof n?(n=0,r=t,o=e,i=1):"number"==typeof r&&"number"==typeof o&&"number"==typeof i||(r=t,o=e,i=n,n=e=t=0),t==r&&e==o&&n==i)throw new Error("It's not a legitimate ray!");var a=Math.sqrt((r-t)*(r-t)+(o-e)*(o-e)),u=0!=a?(o-e)/a:1,c=0!=a?(r-t)/a:0,s=(r-t)*c+(o-e)*u,f=i-n,l=Math.sqrt(s*s+f*f),h=0!=l?f/l:1,p=0!=l?s/l:0;return d.M={A:[[u,-c,0,e*c-t*u],[h*c,u*h,-p,n*p-t*c*h-e*u*h],[c*p,u*p,h,-t*c*p-e*u*p-n*h]],B:[[u,h*c,c*p,t],[-c,h*u,u*p,e],[0,-p,h,n]]},g},g.setP=function(t,e,n){return"number"!=typeof n&&(n=0),d.P=[t,e,n],g},g},y.math.move=function(){var o={},i=function(t,e){if(o.D&&o.P){var n=[o.D[0]*t+o.P[0],o.D[1]*t+o.P[1],o.D[2]*t+o.P[2]];return e&&(o.P=n),n}throw new Error("You shoud first set the direction and position!")};return i.setP=function(t,e,n){return"number"!=typeof n&&(n=0),o.P=[t,e,n],i},i.setD=function(t,e,n){if("number"!=typeof n&&(n=0),0==t&&0==e&&0==n)o.D=[0,0,0];else{var r=Math.sqrt(t*t+e*e+n*n);o.D=[t/r,e/r,n/r]}return i},i},y.math.scale=function(){var r={C:[0,0,0]},o=function(t,e){if(r.P){var n=[t*(r.P[0]-r.C[0])+r.C[0],t*(r.P[1]-r.C[1])+r.C[1],t*(r.P[2]-r.C[2])+r.C[2]];return e&&(r.P=n),n}throw new Error("You shoud first set the position!")};return o.setC=function(t,e,n){return"number"!=typeof n&&(n=0),r.C=[t,e,n],o},o.setP=function(t,e,n){return"number"!=typeof n&&(n=0),r.P=[t,e,n],o},o};var T=function(t,e,n,r){return t+e*r+n*r*r*.5},C=function(t,e,n,r){return t+(e+n)*r*.5};function s(t){if(t&&t.constructor===CanvasRenderingContext2D)return t;var e=y(t);return 0<e.length?e[0].getContext("2d"):void 0}y.scale.map=function(){var l,h,p,d,g,m={c:[107,36],s:1e4,t:"ploar"},e=function(){d=x[0].R/90/m.s,g=d*Math.PI*.5};e();var n=function(t,e){if("ploar"==m.t)return l=l||y.math.rotate().setL(0,0,0,0,0,1),h=h||y.math.rotate().setL(0,0,0,1,0,0),p=p||y.math.rotate().setL(0,1,0,0,0,0),i=t,a=e,u=l,c=h,s=m,f=p.setP(x[0].R/s.s,0,0)(a/180*Math.PI),f=u.setP(f[0],f[1],f[2])(i/180*Math.PI),f=u.setP(f[0],f[1],f[2])((90-s.c[0])/180*Math.PI),[-(f=c.setP(f[0],f[1],f[2])((90-s.c[1])/180*Math.PI))[0],f[1],f[2]];if("cylinder"==m.t)return n=e,r=d,[g*(t-(o=m).c[0]),r*(o.c[1]-n),0];throw new Error("Illegal projection mode!");var n,r,o,i,a,u,c,s,f};return n.type=function(t){return"string"!=typeof t?m.t:(m.t=t,n)},n.scale=function(t){return"number"!=typeof t?m.s:(m.s=t,e(),n)},n.center=function(t,e){return"number"!=typeof t||"number"!=typeof e?m.c:(m.c=[t,e],n)},n},y.layout.tree=function(){var a,n,c={e:{}},i=function(){var o=[],i=0;!function t(e,n){var r;for(r=0;r<e.children.length;r++)t(a[e.children[r]],n+1);(a[e.id].left=n+.5,0==r)?(o[n]==f&&(o[n]=-.5),o[n-1]==f&&(o[n-1]=-.5),a[e.id].top=o[n]+1,o[n]+1+.5*(a[e.pid].children.length-1)-1<o[n-1]&&(a[e.id].top=o[n-1]+1-.5*(a[e.pid].children.length-1))):a[e.id].top=.5*(a[e.children[0]].top+a[e.children[r-1]].top);o[n]=a[e.id].top,a[e.id].top+.5>i&&(i=a[e.id].top+.5)}(a[n],0),c.e.drawer(a,n,i)},u=function(i){var a,t,u={},e=c.e.root(i);return a=t=c.e.id(e),u[a]={data:e,pid:null,id:a,children:[],show:!0},function t(e,n){var r,o=c.e.child(e,i);for(r=0;o&&r<o.length;r++)a=c.e.id(o[r]),u[n].children.push(a),u[a]={data:o[r],pid:n,id:a,children:[],show:!0},t(o[r],a)}(e,a),[t,u]},s=function(t){var e=u(t);return a=e[1],n=e[0],i(),s};return s.bind=function(t,e,n){return c.e[t]=e,s},s.add=function(t,e,n){var r,o=u(e);for(r in o[1][o[0]].pid=t,a[t].children.push(o[0]),o[1])a[r]=o[1][r];return n||i(),s},s.delete=function(t,e){var n=a[a[t].pid].children.indexOf(t);return-1<n&&a[a[t].pid].children.splice(n,1),function t(e){var n;for(n=0;n<a[e].children.length;n++)t(a[a[e].children[n]].id);delete a[e]}(t),e||i(),s},s.toggle=function(t,e,n){var r=a[a[t].pid].children.indexOf(t);return-1<r&&"show"!=n?(a[a[t].pid].children.splice(r,1),a[t]._index=r):"hidden"!=n&&a[a[t].pid].children.splice(a[t]._index,0,t),e||i(),s},s.update=function(){return i(),s},s},y.layout.force=function(){var o,i,a,u,c,s,t,e,n,r,f,l,h,p,d,g,m={e:{},c:{}},y=!1,v=0,x=1,b=1-Math.pow(.001,1/300),w=function(){for(a in c=[],o)c.push([o[a].x,o[a].y]);for(a in u=function(o){var p,i,d={},t=o[0][0],e=o[0][1],n=o[0][0],r=o[0][1];for(p=1;p<o.length;p++)o[p][0]<t?t=o[p][0]:o[p][0]>n&&(n=o[p][0]),o[p][1]<e?e=o[p][1]:o[p][1]>r&&(r=o[p][1]);!function t(e,n,r,o,i,a){var u=.5*(r+o),c=.5*(i+a);if(d[n]={num:e.length,cx:u,cy:c,w:o-r,h:a-i,e:[],children:[]},1!=e.length){var s=[],f=[],l=[],h=[];for(p=0;p<e.length;p++)e[p][0]==u||e[p][1]==c||e[p][0]==r||e[p][0]==o||e[p][1]==i||e[p][1]==a?d[n].e.push(e[p]):e[p][0]<u?e[p][1]<c?s.push(e[p]):l.push(e[p]):e[p][1]<c?f.push(e[p]):h.push(e[p]);0<s.length&&(d[n].children.push(n+"1"),t(s,n+"1",r,u,i,c)),0<f.length&&(d[n].children.push(n+"2"),t(f,n+"2",u,o,i,c)),0<l.length&&(d[n].children.push(n+"3"),t(l,n+"3",r,u,c,a)),0<h.length&&(d[n].children.push(n+"4"),t(h,n+"4",u,o,c,a))}else d[n].e=[e[0]]}(o,"Q",t,n,e,r);var a,u,c,s,f=[],l=function(t,e,n,r,o){if(e==r&&n==o)return[0,0];var i=t*E/((r-e)*(r-e)+(o-n)*(o-n)),a=Math.sqrt((r-e)*(r-e)+(o-n)*(o-n));return[i*(r-e)/a,i*(o-n)/a]};for(p=0;p<o.length;p++)f=function t(e){if(a=d[e],u=o[p],c=a.cx*a.cy,s=(u[0]-a.cx)*(u[0]-a.cx)+(u[1]-a.cy)*(u[1]-a.cy),c/s<=.81)return l(a.num,a.cx,a.cy,u[0],u[1]);var n,r=[0,0];for(i=0;i<a.e.length;i++)n=l(1,a.e[i][0],a.e[i][1],u[0],u[1]),r[0]+=n[0],r[1]+=n[1];for(i=0;i<a.children.length;i++)n=t(a.children[i]),r[0]+=n[0],r[1]+=n[1];return r}("Q"),o[p][2]=f[0],o[p][3]=f[1];return o}(c),c=0,o)o[a].fx+=u[c][2]/m.c.coulomb,o[a].fy+=u[c][3]/m.c.coulomb,c+=1},M=function(){for(a in x+=(0-x)*b,o)o[a].fx=0,o[a].fy=0;for(a in function(){for(a in i)for(u in i[a])t=o[a],e=o[u],n=t.x-e.x,r=t.y-e.y,0!=n&&0!=r&&(f=Math.sqrt(n*n+r*r),c=m.c.spring*(f-(i[a][u].isG?.3*i[a][u].l:i[a][u].l)),l=c*n/f,h=c*r/f,o[a].fx-=l,o[a].fy-=h,o[u].fx+=l,o[u].fy+=h)}(),w(),function(){for(a in o)c=0<o[a].ng?o[a].ng:-1,o[a].fx+=(500-o[a].x)*m.c.center*c,o[a].fy+=(500-o[a].y)*m.c.center*c}(),o)n=T(o[a].x,o[a].vx,o[a].ax,1)-o[a].x,r=T(o[a].y,o[a].vy,o[a].ay,1)-o[a].y,100<(g=n*n+r*r)&&(c=Math.sqrt(100/g),n*=c,r*=c),o[a].x+=n,o[a].y+=r,o[a].x<0&&(o[a].x=0),o[a].y<0&&(o[a].y=0),1e3<o[a].x&&(o[a].x=1e3),1e3<o[a].y&&(o[a].y=1e3),p=o[a].ax*x,d=o[a].ay*x,o[a].ax=o[a].fx/1e3*x,o[a].ay=o[a].fy/1e3*x,o[a].vx=C(o[a].vx,p,o[a].ax,1)*x,o[a].vy=C(o[a].vy,d,o[a].ay,1)*x;if(v<30)v+=1;else{for(a in m.e.live&&"function"==typeof m.e.live[0]&&m.e.live[0](),o)m.e.update[0](o[a]);for(a in i)for(u in i[a])m.e.update[1](o[a],o[u],i[a][u]);m.e.live&&"function"==typeof m.e.live[1]&&m.e.live[1]()}.001<=x?v<30?M():window.setTimeout(function(){M()},40):y=!1},_=function(){x=y?.3:(y=!0,M(),1)},P=function(t,e){o={},i={};var n=Math.ceil(10/Math.sqrt(100/t.length)),r=10/n;for(u={p:[],g:{}},a=0;a<t.length;a++)c=m.e.analyse[0](t[a]),o[c[0]]={orgData:t[a],vx:0,vy:0,ax:0,ay:0,t:[],s:[],id:c[0],g:c[1],ng:0},u.p.push([a%n*r+.5*r,Math.ceil((a+1)/n)*r-.5*r]),u.g[c[1]]=u.g[c[1]]||[],u.g[c[1]].push(c[0]);for(a in s=0,u.g)for(c in u.g[a])o[u.g[a][c]].x=u.p[s][0]+495,o[u.g[a][c]].y=u.p[s][1]+495,s+=1;for(a=0;a<e.length;a++)c=m.e.analyse[1](e[a]),i[c[0]]=i[c[0]]||{},i[c[0]][c[1]]={l:c[2],orgData:e[a],isG:o[c[0]].g==o[c[1]].g},o[c[0]].t.push(c[1]),o[c[1]].s.push(c[0]),o[c[0]].g!=o[c[1]].g&&(o[c[0]].ng+=1,o[c[1]].ng+=1);_()};return P.bind=function(t,e,n){return"function"!=typeof e&&(e=function(){}),"function"!=typeof n&&(n=function(){}),m.e[t]=[e,n],P},P.update=function(t,e,n){return o[t].x=e,o[t].y=n,_(),P},P.config=function(t){for(c in t)m.c[c]=t[c];return P},P};var n=function(t,e,n,r){var o,i=n(r);return i._config=e||{},i._painter=s(t),i.canvas=function(t){return i._painter=s(t),i},i.config=function(t){for(o in t)i._config[o]=t[o];return i},i};y.canvas.layer=function(t,e,n){var r=t?s(t):f,o=[],i={},a={get:function(t){return i[t]&&i[t].constructor===CanvasRenderingContext2D||(o.push(document.createElement("canvas")),o[o.length-1].setAttribute("width",e),o[o.length-1].setAttribute("height",n),i[t]=o[o.length-1].getContext("2d")),i[t]},painter:function(t){return t&&(r=s(t)),r},clean:function(t){return t.clearRect(0,0,e,n),a},update:function(){if(r&&r.constructor===CanvasRenderingContext2D){var t;for(r.clearRect(0,0,e,n),r.save(),t=0;t<o.length;t++)r.drawImage(o[t],0,0,e,n,0,0,e,n);r.restore()}return a}};return a};var r=function(a){var u={c:[0,0],r:[100,140]},c=y.math.rotate().setL(0,0),n=function(t,e,n,r){"number"!=typeof n&&(n=u.r[0]),"number"!=typeof r&&(r=u.r[1]);var o,i=[];return c.setP(u.c[0]+n,u.c[1]),o=c(t,!0),i[0]=o[0],i[1]=o[1],o=c(e),i[2]=o[0],i[3]=o[1],c.setP(u.c[0]+r,u.c[1]),o=c(t,!0),i[4]=o[0],i[5]=o[1],o=c(e),i[6]=o[0],i[7]=o[1],a(u.c[0],u.c[1],n,r,t,t+e,i[0],i[1],i[4],i[5],i[2],i[3],i[6],i[7])};return n.setRadius=function(t,e){return u.r=[t,e],n},n.setCenter=function(t,e){return c.setL(t,e),u.c=[t,e],n},n},h=function(i){var a={n:1,small:[0,0,1],big:[0,0,2],color:"#000"},e=function(t,e){var n,r=(e-t)/a.n,o=[];for(n=t;0<r&&n<=e||r<0&&e<=n;n+=r)o.push(i(n,a.big[0],a.big[1],a.big[2],"function"==typeof a.color?a.color(n):a.color,a)),n+r/5*4<e&&(o.push(i(n+r/5,a.small[0],a.small[1],a.small[2],"function"==typeof a.color?a.color(n+r/5):a.color,a)),o.push(i(n+r/5*2,a.small[0],a.small[1],a.small[2],"function"==typeof a.color?a.color(n+r/5*2):a.color,a)),o.push(i(n+r/5*3,a.small[0],a.small[1],a.small[2],"function"==typeof a.color?a.color(n+r/5*3):a.color,a)),o.push(i(n+r/5*4,a.small[0],a.small[1],a.small[2],"function"==typeof a.color?a.color(n+r/5*4):a.color,a)));return o};return e.set=function(t){return"number"==typeof t.smallLeft&&(a.small[0]=t.smallLeft),"number"==typeof t.smallRight&&(a.small[1]=t.smallRight),"number"==typeof t.smallSize&&(a.small[2]=t.smallSize),"number"==typeof t.bigLeft&&(a.big[0]=t.bigLeft),"number"==typeof t.bigRight&&(a.big[1]=t.bigRight),"number"==typeof t.bigSize&&(a.big[2]=t.bigSize),"string"!=typeof t.color&&"function"!=typeof t.color||(a.color=t.color),"number"==typeof t.num&&(a.n=t.num),"number"==typeof t.cx&&(a.cx=t.cx),"number"==typeof t.cy&&(a.cy=t.cy),"number"==typeof t.radius&&(a.radius=t.radius),"number"==typeof t.seat&&(a.seat=t.seat),"horizontal"!==t.direction&&"vertical"!==t.direction||(a.direction=t.direction),e},e};return y.svg.arc=function(){return r(function(t,e,n,r,o,i,a,u,c,s,f,l,h,p){var d=i-o>Math.PI?1:0,g="M"+a+" "+u;return g+="A"+n+" "+n+" 0 "+d+" 1 "+f+" "+l,g+="L"+h+" "+p,g+="A"+r+" "+r+" 0 "+d+" 0 "+c+" "+s,g+="L"+a+" "+u})},y.svg.arcRuler=function(){return h(function(t,e,n,r,o,i){return[y.svg.arc().setCenter(i.cx,i.cy)(t-r/2,r,i.radius-n,i.radius+e),o]})},y.svg.lineRuler=function(){return h(function(t,e,n,r,o,i){return["vertical"===i.direction?"M"+(i.seat-e)+","+(t-r/2)+"L"+(i.seat+e)+","+(t-r/2)+"L"+(i.seat+n)+","+(t+r/2)+"L"+(i.seat-n)+","+(t+r/2)+"L"+(i.seat-e)+","+(t-r/2):"M"+(t-r/2)+","+(i.seat-n)+"L"+(t+r/2)+","+(i.seat-n)+"L"+(t+r/2)+","+(i.seat+e)+"L"+(t-r/2)+","+(i.seat+e)+"L"+(t-r/2)+","+(i.seat-n),o]})},y.canvas.arc=function(t,e){var d,g=n(t,e,r,function(t,e,n,r,o,i,a,u,c,s,f,l,h,p){for(d in g._painter.moveTo(a,u),g._painter.arc(t,e,n,o,i,!1),g._painter.lineTo(h,p),g._painter.arc(t,e,r,i,o,!0),g._painter.lineTo(a,u),g._config)g._painter[d]=g._config[d];return g._painter.fill(),g._painter});return g},y.canvas.arcRuler=function(t,e){var a,u=n(t,e,h,function(t,e,n,r,o,i){for(a in u._painter.beginPath(),u._config)u._painter[a]=u._config[a];return y.canvas.arc(u._painter,{fillStyle:o}).setCenter(i.cx,i.cy)(t-r/2,r,i.radius-n,i.radius+e),u._painter});return u},y.canvas.lineRuler=function(t,e){var a,u=n(t,e,h,function(t,e,n,r,o,i){for(a in u._painter.beginPath(),u._config)u._painter[a]=u._config[a];return u._painter.fillStyle=o,"vertical"===i.direction?(u._painter.moveTo(i.seat-e,t-r/2),u._painter.lineTo(i.seat+n,t-r/2),u._painter.lineTo(i.seat+n,t+r/2),u._painter.lineTo(i.seat-e,t+r/2)):(u._painter.moveTo(t-r/2,i.seat-n),u._painter.lineTo(t+r/2,i.seat-n),u._painter.lineTo(t+r/2,i.seat+e),u._painter.lineTo(t-r/2,i.seat+e)),u._painter.closePath(),u._painter.fill(),u._painter});return u},o=!1,y.author="心叶",y.email="yelloxing@gmail.com",y.version="1.2.4",t.clay=t.$$=y,y});