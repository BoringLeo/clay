/*!
*
* clay-laboratory - 用于实验未来新功能的基地!
* git+https://github.com/yelloxing/clay.git
* 
* author 心叶
* 
* build Sun Jul 29 2018
*
* Copyright yelloxing
* Released under the MIT license
* 
* Date:Wed Nov 28 2018 14:28:36 GMT+0800 (GMT+08:00)
*/

!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e(t):e(t)}("undefined"!=typeof window?window:this,function(t,f){"use strict";var y=function(t,e){return new y.prototype.init(t,e)};y.prototype.init=function(t,e){this.context=e=e||document;var n,r=u(t,e);for(n=0;n<r.length;n++)this[n]=r[n];return this.selector=t,this.length=r.length,this},y.prototype.init.prototype=y.prototype;var o={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},m={whitespace:"[\\x20\\t\\r\\n\\f]",identifier:"(?:\\\\.|[\\w-]|[^\0-\\xa0])+"},i=["href","title","show","type","role","actuate"];function u(t,e){var n,r=[];if("string"!=typeof t){if(!t||1!==t.nodeType&&11!==t.nodeType&&9!==t.nodeType){if(!t||t.constructor!==Array&&t.constructor!==HTMLCollection&&t.constructor!==NodeList)return t&&t.constructor===y?t:[];for(n=0;n<t.length;n++)!t[n]||1!==t[n].nodeType&&11!==t[n].nodeType&&9!==t[n].nodeType||r.push(t[n]);return r}return[t]}if("*"===(t=(t+"").trim().replace(/[\n\f\r]/g,"")))return e.getElementsByTagName("*");var i=m.whitespace,o=m.identifier,u="\\["+i+"{0,}"+o+"(?:"+i+"{0,}="+i+"{0,}(\\'|\\\"){0,1}"+o+"\\1{0,1}){0,1}"+i+"{0,}\\]";if(new RegExp("^(?:"+o+"){0,1}(?:(?:#|\\.)"+o+"|"+u+"){0,}$").test(t)){var a,c=t.match(new RegExp("#"+o,"g")),s=t.match(new RegExp("\\."+o,"g")),f=t.match(new RegExp("^"+o)),h=t.match(new RegExp(u,"g"));if(c){if(1<c.length)return[];a=(a=document.getElementById((c.shift(0)+"").replace(/^#/,"")))?[a]:[]}else a=e.getElementsByClassName&&s?e.getElementsByClassName((s.shift(0)+"").replace(/^\./,"")):f?e.getElementsByTagName(f.shift(0)):e.getElementsByTagName("*");var l,p,d,g,v=new RegExp("^\\["+i+"{0,}("+o+")(?:"+i+"{0,}="+i+"{0,}(?:\\'|\\\"){0,1}("+o+")(?:\\'|\\\"){0,1}){0,1}"+i+"{0,}\\]$");for(n=0;n<a.length;n++)if(g=!0,!(f&&0<f.length&&(f[0]+"").toUpperCase()!==(a[n].tagName+"").toUpperCase())){for(l=" "+a[n].getAttribute("class")+" ",p=0;g&&s&&p<s.length;p++)if(l.search(" "+(s[p]+"").replace(/\./,"")+" ")<0){g=!1;break}for(p=0;g&&h&&p<h.length;p++)if(l=v.exec(h[p]),null===(d=a[n].getAttribute(l[1]))||l[2]&&d!=l[2]){g=!1;break}g&&r.push(a[n])}return r}try{return[x(t)]}catch(t){return[]}}function x(t){var e=document.createElementNS(o.svg,"svg");new RegExp("^"+m.identifier+"$").test(t)&&(t="<"+t+"></"+t+">"),e.innerHTML=t;var n,r,i=e.childNodes;for(n=0;n<i.length;n++)if(1===i[n].nodeType||9===i[n].nodeType||11===i[n].nodeType){r=i[n];break}if("canvas"==r.tagName||/[A-Z]/.test(r.tagName))for((e=document.createElement("div")).innerHTML=t,i=e.childNodes,n=0;n<i.length;n++)if(1===i[n].nodeType||9===i[n].nodeType||11===i[n].nodeType){r=i[n];break}return r}y.prototype.find=function(t){if(this.length<=0)return y();var e,n=y(),r=u(t,this[0]);for(n.selector=t,e=0;e<r.length;e++)n[e]=r[e],n.length+=1;return n},y.prototype.eq=function(t){return this.length<=t?new y:new y(this[t])},y.prototype.appendTo=function(t){var e,n,r=y(t);for(e=0;e<r.length;e++)for(n=0;n<this.length;n++)r[e].appendChild(this[n]);return this},y.prototype.remove=function(){var t;for(t=0;t<this.length;t++)this[t].parentNode.removeChild(this[t]);return this},y.prototype.refresh=function(){var t,e=u(this.selector,this.context),n=this.length;for(t=this.length=0;t<e.length;t++)this[t]=e[t],this.length+=1;for(;t<n;t++)delete this[t];return this},y.prototype.attr=function(t,e){if(null==e||e==f)return 0<this.length?this[0].getAttribute(t):f;var n,r;for(n=0;n<this.length;n++)r="function"==typeof e?e(this[n]._data,n,this.eq(n)):e,/[A-Z]/.test(this[n].tagName)&&0<=i.indexOf(t)?this[n].setAttributeNS(o.xlink,"xlink:"+t,r):this[n].setAttribute(t,r);return this},y.prototype.css=function(t,e){if(arguments.length<=1&&"object"!=typeof t){if(this.length<1)return f;var n=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(this[0],null):this[0].currentStyle;return"string"==typeof t?n.getPropertyValue(t):n}var r,i;if(0<this.length)if("object"==typeof t)for(i in t)for(r=0;r<this.length;r++)this[r].style[i]="function"==typeof e?e(this[r]._data,r,i,t[i]):t[i];else for(r=0;r<this.length;r++)this[r].style[t]="function"==typeof e?e(this[r]._data,r):e;return this},y.prototype.size=function(t){var e,n;return"content"==(t=t||"border")?(n=this[0].clientWidth-(this.css("padding-left")+"").replace("px","")-(this.css("padding-right")+"").replace("px",""),e=this[0].clientHeight-(this.css("padding-top")+"").replace("px","")-(this.css("padding-bottom")+"").replace("px","")):"padding"==t?(n=this[0].clientWidth,e=this[0].clientHeight):"border"==t?(n=this[0].offsetWidth,e=this[0].offsetHeight):"scroll"==t&&(n=this[0].scrollWidth,e=this[0].scrollHeight),{width:n,height:e}},y.prototype.datum=function(t,e){if(null===t||t===f)return 0<this.length?this[0]._data:f;var n;for(n=0;n<this.length;n++)t="function"==typeof e?e(t,n):t,this[n]._data=t;return this},y.prototype.data=function(t,e){var n,r=[];if(t&&t.constructor===Array){var i=y();for(i.selector=this.selector,n=0;n<t.length&&n<this.length;n++)this[n]._data="function"==typeof e?e(t[n],n):t[n],i[n]=this[n],i.length+=1;for(i._enter=[];n<t.length;n++)i._enter.push("function"==typeof e?e(t[n],n):t[n]);for(i._exit=[];n<this.length;n++)i._exit.push(this[n]);return i}for(n=0;n<this.length;n++)r[n]=this[n]._data;return r},y.prototype.enter=function(t){var e,n,r=y();for(r.selector=this.selector,e=0;this._enter&&e<this._enter.length;e++)(n=x(t))._data=this._enter[e],r[e]=n,r.length+=1;return delete this._enter,r},y.prototype.exit=function(){var t,e=y();for(e.selector=this.selector,t=0;this._exit&&t<this._exit.length;t++)e[t]=this._exit[t],e.length+=1;return delete this._exit,e},y.prototype.bind=function(t,e){var n;if(window.attachEvent)for(n=0;n<this.length;n++)this[n].attachEvent("on"+t,e);else for(n=0;n<this.length;n++)this[n].addEventListener(t,e,!1);return this},y.prototype.unbind=function(t,e){var n;if(window.detachEvent)for(n=0;n<this.length;n++)this[n].detachEvent("on"+t,e);else for(n=0;n<this.length;n++)this[n].removeEventListener(t,e,!1);return this},y.prototype.position=function(t){var e=this[0].getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}};var c={timers:[],interval:13,speeds:400,timerId:null};y.animation=function(e,t,n){c.timer(function(t){e(t)},t,n)},c.timer=function(t,e,n){if("function"!=typeof t)throw new Error("tick is required!");(e="number"==typeof e?e:c.speeds)<0&&(e=-e),c.timers.push({createTime:new Date,tick:t,duration:e,callback:n}),c.start()},c.start=function(){c.timerId||(c.timerId=setInterval(c.tick,c.interval))},c.tick=function(){var t,e,n,r,i,o,u,a=c.timers;for(c.timers=[],e=c.timers.length=0;e<a.length;e++)t=(i=a[e]).createTime,n=i.tick,o=i.duration,r=i.callback,!1,1<=(u=(+new Date-t)/o)&&!0,n(u=1<u?1:u),u<1?c.timers.push(i):r&&r();c.timers.length<=0&&c.stop()},c.stop=function(){c.timerId&&(clearInterval(c.timerId),c.timerId=null)},y.color=function(t){var e=y("head").css("color",t).css("color").replace(/^rgba?\(([^)]+)\)$/,"$1").split(new RegExp("\\,"+m.whitespace));return[+e[0],+e[1],+e[2],e[3]==f?1:+e[3]]},y.getColors=function(t){if("number"==typeof t&&3<t){var e=[],n=0;for(n=1;n<=t;n++)e.push("rgb("+(230*Math.random(1)+20).toFixed(0)+","+(230*Math.random(1)+20).toFixed(0)+","+(230*Math.random(1)+20).toFixed(0)+")");return e}return["rgb(255,0,0)","rgb(0,255,0)","rgb(0,0,255)"]},y.loop=function(t,e){var n,r=0;for(n in t)e(t[n],n,r++);return y};var a=function(e){var t,n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(n.open(e.type,e.url,!0),n.timeout=e.timeout,"function"==typeof e.fileload){var r=function(t){t.lengthComputable&&e.fileload(t.loaded/t.total)};n.onprogress=r,n.upload.onprogress=r}for(t in"function"==typeof e.success&&(n.onload=function(){e.success({response:n.response,status:n.status,header:n.getAllResponseHeaders()})}),"function"==typeof e.error&&(n.onerror=function(){e.error({type:"error"})},n.ontimeout=function(){e.error({type:"timeout"})}),e.header)n.setRequestHeader(t,e.header[t]);n.send(e.data)};y.post=function(i,o){return function(t,e,n,r){a({type:"POST",url:t,success:n,error:r,timeout:o||300,header:i||{},data:e?JSON.stringify(e):""})}},y.get=function(r,i){return function(t,e,n){a({type:"GET",url:t,success:e,error:n,timeout:i||300,header:r||{}})}};var s=function(t,e,n,r){return t.beginPath(),t.fillStyle=e,t.strokeStyle=e,"function"!=typeof n?t:(n(t),r)};function h(t){if(t&&t.constructor===CanvasRenderingContext2D)return t;var e=y(t);return 0<e.length?e[0].getContext("2d"):void 0}y.prototype.region=function(){var i={},t=document.createElement("canvas"),n=[0,0,0],r="r";t.setAttribute("width",this[0].offsetWidth),t.setAttribute("height",this[0].offsetHeight);var o=this,u=t.getContext("2d"),a={drawer:function(t,e){return i[t]==f&&(i[t]={r:function(){return n[0]+=1,r="g","rgb("+n[0]+","+n[1]+","+n[2]+")"},g:function(){return n[1]+=1,r="b","rgb("+n[0]+","+n[1]+","+n[2]+")"},b:function(){return n[2]+=1,r="r","rgb("+n[0]+","+n[1]+","+n[2]+")"}}[r]()),s(u,i[t],e,a)},erase:function(t){return s(u,"rgb(0,0,0)",t,a)},getRegion:function(t){var e,n=o.position(t);n.x-=o.css("border-left-width").replace("px",""),n.y-=o.css("border-top-width").replace("px","");var r=u.getImageData(n.x-.5,n.y-.5,1,1).data;for(e in i)if("rgb("+r[0]+","+r[1]+","+r[2]+")"==i[e])return[e,n.x,n.y];return f}};return a},y.prototype.painter=function(){if(0<this.length&&"CANVAS"!=this[0].nodeName&&"canvas"!=this[0].nodeName)throw new Error("painter is not function");return h(this)},y.prototype.layer=function(){if(0<this.length&&"CANVAS"!=this[0].nodeName&&"canvas"!=this[0].nodeName)throw new Error("layer is not function");var e=h(this),n=[],r={},i=this[0].clientWidth,o=this[0].clientHeight,u={painter:function(t){return r[t]&&r[t].constructor===CanvasRenderingContext2D||(n.push(document.createElement("canvas")),n[n.length-1].setAttribute("width",i),n[n.length-1].setAttribute("height",o),r[t]=n[n.length-1].getContext("2d")),r[t]},clean:function(t){return t&&(t.constructor!==CanvasRenderingContext2D&&(t=u.painter(t)),t.clearRect(0,0,i,o)),u},update:function(){if(e&&e.constructor===CanvasRenderingContext2D){var t;for(e.clearRect(0,0,i,o),e.save(),t=0;t<n.length;t++)e.drawImage(n[t],0,0,i,o,0,0,i,o);e.restore()}return u}};return u};var d=function(t,e){var n,r,i=[];for(n=0;n<4;n++)for(r=0;r<e.length/4;r++)i[4*r+n]=t[n]*e[4*r]+t[n+4]*e[4*r+1]+t[n+8]*e[4*r+2]+t[n+12]*e[4*r+3];return i};y.Matrix4=function(t){var l=t||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p={move:function(t,e,n,r){return l=d(function(t,e,n,r){r=r||0;var i=Math.sqrt(e*e+n*n+r*r);return[1,0,0,0,0,1,0,0,0,0,1,0,e*t/i,n*t/i,r*t/i,1]}(t,e,n,r),l),p},rotate:function(t,e,n,r,i,o,u){var a,c,s,f=function(t,e,n,r,i,o){if("number"!=typeof t||"number"!=typeof e)throw new Error("a1 and b1 is required!");if("number"!=typeof n?(n=0,r=t,i=e,o=1):"number"==typeof r&&"number"==typeof i&&"number"==typeof o||(r=t,i=e,o=n,n=e=t=0),t==r&&e==i&&n==o)throw new Error("It's not a legitimate ray!");var u=Math.sqrt((r-t)*(r-t)+(i-e)*(i-e)),a=0!=u?(i-e)/u:1,c=0!=u?(r-t)/u:0,s=(r-t)*c+(i-e)*a,f=o-n,h=Math.sqrt(s*s+f*f),l=0!=h?f/h:1,p=0!=h?s/h:0;return[[a,l*c,c*p,0,-c,a*l,a*p,0,0,-p,l,0,e*c-t*a,n*p-t*c*l-e*a*l,-t*c*p-e*a*p-n*l,1],[a,-c,0,0,l*c,l*a,-p,0,c*p,a*p,l,0,t,e,n,1]]}(e,n,r,i,o,u);return l=d(d(d(f[1],(a=t,c=Math.sin(a),[s=Math.cos(a),c,0,0,-c,s,0,0,0,0,1,0,0,0,0,1])),f[0]),l),p},scale:function(t,e,n,r,i,o){var u,a,c,s,f,h;return l=d([u=t,0,0,0,0,a=e,0,0,0,0,c=n,0,(s=(s=r)||0)-s*u,(f=(f=i)||0)-f*a,(h=(h=o)||0)-h*c,1],l),p},multiply:function(t,e){return l=e?d(l,t):d(t,l),p},use:function(t,e,n,r){var i=d(l,[t,e,n=n||0,r=r||1]);return i[0]=i[0].toFixed(7),i[1]=i[1].toFixed(7),i[2]=i[2].toFixed(7),i},value:function(){return l}};return p},y.hermite=function(){var c={u:.5},s=function(t){if(c.MR){var e=(t-c.a)/(c.b-c.a),n=e*e;return(e*n*c.MR[0]+n*c.MR[1]+e*c.MR[2]+c.MR[3])*(c.b-c.a)}throw new Error("You shoud first set the position!")};return s.setU=function(t){if("number"!=typeof t)throw new Error("Expecting a figure!");return c.u=.5*(1-t),s},s.setP=function(t,e,n,r,i,o){if(!(t<n))throw new Error("The point position should be increamented!");c.a=t,c.b=n;var u=c.u*i,a=c.u*o;return e/=n-t,r/=n-t,c.MR=[2*e-2*r+u+a,3*r-3*e-2*u-a,u,e],s},s},y.cardinal=function(){var e,i={t:0},o=function(t){if(i.hs){for(e=-1;e+1<i.hs.x.length&&(t>i.hs.x[e+1]||-1==e&&t>=i.hs.x[e+1]);)e+=1;if(-1==e||e>=i.hs.h.length)throw new Error("Coordinate crossing!");return i.hs.h[e](t)}throw new Error("You shoud first set the position!")};return o.setU=function(t){if("number"!=typeof t)throw new Error("Expecting a figure!");return i.t=t,o},o.setP=function(t){i.hs={x:[],h:[]};var e,n,r=(t[1][1]-t[0][1])/(t[1][0]-t[0][0]);for(i.hs.x[0]=t[0][0],e=1;e<t.length;e++){if(t[e][0]<=t[e-1][0])throw new Error("The point position should be increamented!");i.hs.x[e]=t[e][0],n=e<t.length-1?(t[e+1][1]-t[e-1][1])/(t[e+1][0]-t[e-1][0]):(t[e][1]-t[e-1][1])/(t[e][0]-t[e-1][0]),i.hs.h[e-1]=y.hermite().setU(i.t).setP(t[e-1][0],t[e-1][1],t[e][0],t[e][1],r,n),r=n}return o},o};var v=function(t,e,n,r){var i=Math.cos(t),o=Math.sin(t);return[e*i-n*o,e*o+n*i,r]};y.map=function(){var d,g={c:[107,36],s:1},n=function(t,e){var n,r,i,o,u,a,c,s,f,h,l,p;return n=(360-e)/180*Math.PI,r=100*g.s,o=i=0,u=Math.cos(n),a=Math.sin(n),d=[o*a+r*u,i,o*u-r*a],d=v(t/180*Math.PI,d[0],d[1],d[2]),d=v((90-g.c[0])/180*Math.PI,d[0],d[1],d[2]),c=(90-g.c[1])/180*Math.PI,s=d[0],f=d[1],h=d[2],l=Math.cos(c),p=Math.sin(c),[-(d=[s,f*l-h*p,f*p+h*l])[0],d[1],d[2]]};return n.scale=function(t){return"number"==typeof t&&(g.s=t),n},n.center=function(t,e){return"number"==typeof t&&"number"==typeof e&&(g.c=[t,e]),n},n};var M=function(t,e,n,r){return t+e*r+n*r*r*.5},R=function(t,e,n,r){return t+(e+n)*r*.5};y.rotate=function(t,e,n,r,i){var o=Math.cos(n),u=Math.sin(n);return[1e14*((r-t)*o-(i-e)*u+t)/1e14,1e14*((r-t)*u+(i-e)*o+e)/1e14]},y.rotate=function(t,e,n,r,i){var o=Math.cos(n),u=Math.sin(n);return[((r-t)*o-(i-e)*u+t).toFixed(7),((r-t)*u+(i-e)*o+e).toFixed(7)]},y.move=function(t,e,n,r,i){var o=Math.sqrt(t*t+e*e);return[(t*n/o+r).toFixed(7),(e*n/o+i).toFixed(7)]},y.scale=function(t,e,n,r,i){return[(n*(r-t)+t).toFixed(7),(n*(i-e)+e).toFixed(7)]},y.svg={},y.canvas={};var r=function(t,e,n,r){var i,o=n(r);if(o._p=h(t),e)for(i in e)o._p[i]=e[i];return o.painter=function(t){return o._p=h(t),o},o.config=function(t){for(i in t)o._p[i]=t[i];return o},o},n=function(u){var a={c:[0,0],r:[100,140]},n=function(t,e,n,r){"number"!=typeof n&&(n=a.r[0]),"number"!=typeof r&&(r=a.r[1]);var i,o=[];return i=v(t,n,0,0),o[0]=i[0],o[1]=i[1],i=v(e,i[0],i[1],0),o[2]=i[0],o[3]=i[1],i=v(t,r,0,0),o[4]=i[0],o[5]=i[1],i=v(e,i[0],i[1],0),o[6]=i[0],o[7]=i[1],u(a.c[0],a.c[1],n,r,t,t+e,o[0]+a.c[0],o[1]+a.c[1],o[4]+a.c[0],o[5]+a.c[1],o[2]+a.c[0],o[3]+a.c[1],o[6]+a.c[0],o[7]+a.c[1])};return n.setRadius=function(t,e){return a.r=[t,e],n},n.setCenter=function(t,e){return a.c=[t,e],n},n};y.svg.arc=function(){return n(function(t,e,n,r,i,o,u,a,c,s,f,h,l,p){var d=o-i>Math.PI?1:0,g="M"+u+" "+a;return g+="A"+n+" "+n+" 0 "+d+" 1 "+f+" "+h,g+="L"+l+" "+p,g+="A"+r+" "+r+" 0 "+d+" 0 "+c+" "+s,g+="L"+u+" "+a})},y.canvas.arc=function(t,e){var d=r(t,e,n,function(t,e,n,r,i,o,u,a,c,s,f,h,l,p){return d._p.beginPath(),d._p.moveTo(u,a),d._p.arc(t,e,n,i,o,!1),d._p.lineTo(l,p),d._p.arc(t,e,r,o,i,!0),d._p.lineTo(u,a),d._p});return d};var l=function(u){var a={s:10,t:["LR"]},r=function(t,e,n,r){var i,o=.5*a.s;switch("RL"!=a.t[0]&&"BT"!=a.t[0]||(n=-n,a.t[0]={RL:"LR",BT:"TB"}[a.t[0]]),a.t[0]){case"LR":i=[[t,e-o],[t+n,e-o],[t+n,e+o],[t,e+o]];break;case"TB":i=[[t+o,e],[t+o,e+n],[t-o,e+n],[t-o,e]];break;default:i=[y.rotate(a.t[1],a.t[2],r+a.t[0],t,e-o),y.rotate(a.t[1],a.t[2],r+a.t[0],t+n,e-o),y.rotate(a.t[1],a.t[2],r+a.t[0],t+n,e+o),y.rotate(a.t[1],a.t[2],r+a.t[0],t,e+o)]}return u(i)};return r.setSize=function(t){return a.s=t,r},r.setType=function(t,e,n){return a.t=[t,e,n],r},r};y.svg.rect=function(){return l(function(t){return"M"+t[0][0]+","+t[0][1]+" L"+t[1][0]+","+t[1][1]+" L"+t[2][0]+","+t[2][1]+" L"+t[3][0]+","+t[3][1]+" L"+t[0][0]+","+t[0][1]+" "})},y.canvas.rect=function(t,e){var n=r(t,e,l,function(t){return n._p.beginPath(),n._p.moveTo(t[0][0],t[0][1]),n._p.lineTo(t[1][0],t[1][1]),n._p.lineTo(t[2][0],t[2][1]),n._p.lineTo(t[3][0],t[3][1]),n._p.lineTo(t[0][0],t[0][1]),n._p});return n};var p=function(o){var u={d:5},a=y.hermite().setU(-1),e=function(t){for(var e,n,r=0,i="M"+t[0][0]+","+t[0][1];r<t.length-1;r++)e=0==r?0:r-1,n=r==t.length-2?t.length-1:r+2,a.setP(t[r][0],t[r][1],t[r+1][0],t[r+1][1],(t[r+1][1]-t[e][1])/(t[r+1][0]-t[e][0]),(t[n][1]-t[r][1])/(t[n][0]-t[r][0])),i=o(a,t[r][0],t[r+1][0],i,u.d);return i};return e.setPrecision=function(t){return u.d=t,e},e.setU=function(t){return a.setU(t),e},e};y.svg.line=function(){return p(function(t,e,n,r,i){for(;e<n;e+=i)r=r+" L"+e+","+t(e);return r=r+" L"+n+","+t(n)})},y.canvas.line=function(t,e){var o=r(t,e,p,function(t,e,n,r,i){for("string"==typeof r&&(o._p.beginPath(),o._p.moveTo(e,t(e)));e<n;e+=i)o._p.lineTo(e,t(e));return o._p.lineTo(n,t(n)),o._p});return o};var g=function(i){var o={p:[]},n=function(t,e,n,r){return r=r?180*r/Math.PI:0,i(t,e,n,r,o.p[0],o.p[1],o.c||"#000",o.s||16)};return n.setAlign=function(t,e){return o.p=[t,e],n},n.setSize=function(t){return o.s=t,n},n.setColor=function(t){return o.c=t,n},n};y.svg.text=function(){return g(function(t,e,n,r,i,o,u,a){return y("<text fill="+u+' x="'+t+'" y="'+e+'" '+(r?"":"transform='rotate("+r+","+t+","+e+")'")+">"+n+"</text>").css({"text-anchor":{left:"start",right:"end"}[i]||"middle","dominant-baseline":{top:"text-after-edge",bottom:"text-before-edge"}[o]||"middle","font-size":a})})},y.canvas.text=function(t,e){var c=r(t,e,g,function(t,e,n,r,i,o,u,a){return c._p.save(),c._p.beginPath(),c._p.textAlign={left:"start",right:"end"}[i]||"center",c._p.textBaseline={top:"top",bottom:"bottom"}[o]||"middle",c._p.font=a+"px sans-serif",c._p.translate(t,e),c._p.rotate(r),c._p.fillStyle=u,c._p.fillText(n,t,e),c._p.restore(),c._p});return c};var w=function(u){var a={},r=function(t,e,n,r){var i,o;if("normal"==a.t[2])i=[a.t[0],a.t[1]],o=[-a.t[0],-a.t[1]];else{if("circle"!=a.t[2])throw new Error("Illegal type!");i=[t-a.t[0],e-a.t[1]],o=[a.t[0]-n,a.t[1]-r]}return u([t,e],[n,r],y.move(i[0],i[1],a.l,t,e),y.move(o[0],o[1],a.l,n,r))};return r.setType=function(t,e,n){return n||(n="normal"),a.t=[t,e,n],r},r.setL=function(t){return a.l=t,r},r};y.svg.bezier=function(){return w(function(t,e,n,r){return"M"+t[0]+","+t[1]+" C"+n[0]+","+n[1]+" "+r[0]+","+r[1]+" "+e[0]+","+e[1]})},y.canvas.bezier=function(t,e){var i=r(t,e,w,function(t,e,n,r){return i._p.beginPath(),i._p.moveTo(t[0],t[1]),i._p.bezierCurveTo(n[0],n[1],r[0],r[1],e[0],e[1]),i._p});return i},y.treeLayout=function(){var u,n,c={e:{}},o=function(){var i=[],o=0;!function t(e,n){var r;for(r=0;r<e.children.length;r++)t(u[e.children[r]],n+1);(u[e.id].left=n+.5,0==r)?(i[n]==f&&(i[n]=-.5),i[n-1]==f&&(i[n-1]=-.5),u[e.id].top=i[n]+1,i[n]+1+.5*(u[e.pid].children.length-1)-1<i[n-1]&&(u[e.id].top=i[n-1]+1-.5*(u[e.pid].children.length-1))):u[e.id].top=.5*(u[e.children[0]].top+u[e.children[r-1]].top);i[n]=u[e.id].top,u[e.id].top+.5>o&&(o=u[e.id].top+.5)}(u[n],0),c.e.drawer(u,n,o)},a=function(o){var u,t,a={},e=c.e.root(o);return u=t=c.e.id(e),a[u]={data:e,pid:null,id:u,children:[],show:!0},function t(e,n){var r,i=c.e.child(e,o);for(r=0;i&&r<i.length;r++)u=c.e.id(i[r]),a[n].children.push(u),a[u]={data:i[r],pid:n,id:u,children:[],show:!0},t(i[r],u)}(e,u),[t,a]},s=function(t){var e=a(t);return u=e[1],n=e[0],o(),s};return s.bind=function(t,e,n){return c.e[t]=e,s},s.add=function(t,e,n){var r,i=a(e);for(r in i[1][i[0]].pid=t,u[t].children.push(i[0]),i[1])u[r]=i[1][r];return n||o(),s},s.delete=function(t,e){var n=u[u[t].pid].children.indexOf(t);return-1<n&&u[u[t].pid].children.splice(n,1),function t(e){var n;for(n=0;n<u[e].children.length;n++)t(u[u[e].children[n]].id);delete u[e]}(t),e||o(),s},s.toggle=function(t,e,n){var r=u[u[t].pid].children.indexOf(t);return-1<r&&"show"!=n?(u[u[t].pid].children.splice(r,1),u[t]._index=r):"hidden"!=n&&u[u[t].pid].children.splice(u[t]._index,0,t),e||o(),s},s.update=function(){return o(),s},s},y.forceLayout=function(){var i,o,u,a,c,s,t,e,n,r,f,h,l,p,d,g,v={e:{},c:{}},y=!1,m=0,x=1,w=1-Math.pow(.001,1/300),b=function(){for(u in c=[],i)c.push([i[u].x,i[u].y]);for(u in a=function(i){var p,o,d={},t=i[0][0],e=i[0][1],n=i[0][0],r=i[0][1];for(p=1;p<i.length;p++)i[p][0]<t?t=i[p][0]:i[p][0]>n&&(n=i[p][0]),i[p][1]<e?e=i[p][1]:i[p][1]>r&&(r=i[p][1]);!function t(e,n,r,i,o,u){var a=.5*(r+i),c=.5*(o+u);if(d[n]={num:e.length,cx:a,cy:c,w:i-r,h:u-o,e:[],children:[]},1!=e.length){var s=[],f=[],h=[],l=[];for(p=0;p<e.length;p++)e[p][0]==a||e[p][1]==c||e[p][0]==r||e[p][0]==i||e[p][1]==o||e[p][1]==u?d[n].e.push(e[p]):e[p][0]<a?e[p][1]<c?s.push(e[p]):h.push(e[p]):e[p][1]<c?f.push(e[p]):l.push(e[p]);0<s.length&&(d[n].children.push(n+"1"),t(s,n+"1",r,a,o,c)),0<f.length&&(d[n].children.push(n+"2"),t(f,n+"2",a,i,o,c)),0<h.length&&(d[n].children.push(n+"3"),t(h,n+"3",r,a,c,u)),0<l.length&&(d[n].children.push(n+"4"),t(l,n+"4",a,i,c,u))}else d[n].e=[e[0]]}(i,"Q",t,n,e,r);var u,a,c,s,f=[],h=function(t,e,n,r,i){if(e==r&&n==i)return[0,0];var o=t/((r-e)*(r-e)+(i-n)*(i-n)),u=Math.sqrt((r-e)*(r-e)+(i-n)*(i-n));return[o*(r-e)/u,o*(i-n)/u]},l=function(t,e){if(u=d[t],a=i[e],c=u.cx*u.cy,s=(a[0]-u.cx)*(a[0]-u.cx)+(a[1]-u.cy)*(a[1]-u.cy),c/s<=.81)return h(u.num,u.cx,u.cy,a[0],a[1]);var n,r=[0,0];for(o=0;o<u.e.length;o++)n=h(1,u.e[o][0],u.e[o][1],a[0],a[1]),r[0]+=n[0],r[1]+=n[1];for(o=0;o<u.children.length;o++)n=l(u.children[o],e),r[0]+=n[0],r[1]+=n[1];return r};for(p=0;p<i.length;p++)f=l("Q",p),i[p][2]=f[0],i[p][3]=f[1];return i}(c),c=0,i)i[u].fx+=a[c][2]/v.c.coulomb,i[u].fy+=a[c][3]/v.c.coulomb,c+=1},_=function(){for(u in x+=(0-x)*w,i)i[u].fx=0,i[u].fy=0;for(u in function(){for(u in o)for(a in o[u])t=i[u],e=i[a],n=t.x-e.x,r=t.y-e.y,0!=n&&0!=r&&(f=Math.sqrt(n*n+r*r),c=v.c.spring*(f-(o[u][a].isG?o[u][a].l*v.c.scale:o[u][a].l)),h=c*n/f,l=c*r/f,i[u].fx-=h,i[u].fy-=l,i[a].fx+=h,i[a].fy+=l)}(),b(),function(){for(u in i)c=0<i[u].ng?i[u].ng:-1,i[u].fx+=(500-i[u].x)*v.c.center*c,i[u].fy+=(500-i[u].y)*v.c.center*c}(),i)n=M(i[u].x,i[u].vx,i[u].ax,1)-i[u].x,r=M(i[u].y,i[u].vy,i[u].ay,1)-i[u].y,100<(g=n*n+r*r)&&(c=Math.sqrt(100/g),n*=c,r*=c),i[u].x+=n,i[u].y+=r,i[u].x<0&&(i[u].x=0),i[u].y<0&&(i[u].y=0),1e3<i[u].x&&(i[u].x=1e3),1e3<i[u].y&&(i[u].y=1e3),p=i[u].ax*x,d=i[u].ay*x,i[u].ax=i[u].fx/1e3*x,i[u].ay=i[u].fy/1e3*x,i[u].vx=R(i[u].vx,p,i[u].ax,1)*x,i[u].vy=R(i[u].vy,d,i[u].ay,1)*x;if(m<30)m+=1;else{for(u in v.e.live&&"function"==typeof v.e.live[0]&&v.e.live[0](),i)v.e.update[0](i[u]);for(u in o)for(a in o[u])v.e.update[1](i[u],i[a],o[u][a]);v.e.live&&"function"==typeof v.e.live[1]&&v.e.live[1]()}.001<=x?m<30?_():window.setTimeout(function(){_()},40):y=!1},T=function(){x=y?x<.3?.3:x:(y=!0,_(),1)},E=function(t,e){i={},o={};var n=Math.ceil(10/Math.sqrt(100/t.length)),r=10/n;for(a={p:[],g:{}},u=0;u<t.length;u++)c=v.e.analyse[0](t[u]),i[c[0]]={orgData:t[u],vx:0,vy:0,ax:0,ay:0,t:[],s:[],id:c[0],g:c[1],ng:0,ig:0},a.p.push([u%n*r+.5*r,Math.ceil((u+1)/n)*r-.5*r]),a.g[c[1]]=a.g[c[1]]||[],a.g[c[1]].push(c[0]);for(u in s=0,a.g)for(c in a.g[u])i[a.g[u][c]].x=a.p[s][0]+495,i[a.g[u][c]].y=a.p[s][1]+495,s+=1;for(u=0;u<e.length;u++)c=v.e.analyse[1](e[u]),o[c[0]]=o[c[0]]||{},o[c[0]][c[1]]={l:c[2],orgData:e[u],isG:i[c[0]].g==i[c[1]].g},i[c[0]].t.push(c[1]),i[c[1]].s.push(c[0]),i[c[0]].g!=i[c[1]].g?(i[c[0]].ng+=1,i[c[1]].ng+=1):(i[c[0]].ig+=1,i[c[1]].ig+=1);T()};return E.bind=function(t,e,n){return"function"!=typeof e&&(e=function(){}),"function"!=typeof n&&(n=function(){}),v.e[t]=[e,n],E},E.update=function(t,e,n){return i[t].x=e,i[t].y=n,T(),E},E.config=function(t){for(c in t)v.c[c]=t[c];return E},E};var b=function(t,e,n){var r=t.createShader(e);if(null==r)throw new Error("Unable to create shader!");if(t.shaderSource(r,n),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw new Error("Failed to compile shader:"+t.getShaderInfoLog(r));return r};return y.prototype.webgl=function(t){if(0<this.length&&"CANVAS"!=this[0].nodeName&&"canvas"!=this[0].nodeName)throw new Error("Webgl is not a function!");var v=function(t,e){if(t&&t.constructor===WebGLRenderingContext)return t;var n,r=y(t),i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],o=null;if(0<r.length)for(n=0;n<i.length;n++){try{o=r[0].getContext(i[n],e)}catch(t){}if(o)break}return o}(this,t),a={painter:function(){return v},shader:function(t,e){return v.program=function(t,e,n){var r=b(t,t.VERTEX_SHADER,e),i=b(t,t.FRAGMENT_SHADER,n),o=t.createProgram();if(t.attachShader(o,r),t.attachShader(o,i),t.linkProgram(o),!t.getProgramParameter(o,t.LINK_STATUS))throw new Error("Failed to link program: "+t.getProgramInfoLog(o));return t.useProgram(o),o}(v,t,e),a},buffer:function(u){var d,t,e,n,r,i=(e=u,n=(t=v).createBuffer(),r=e?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER,t.bindBuffer(r,n),n),g={write:function(t,e){var n,r,i,o;return e=e||v.STATIC_DRAW,n=v,r=t,i=e,o=u?n.ELEMENT_ARRAY_BUFFER:n.ARRAY_BUFFER,n.bufferData(o,r,i),d=t,g},use:function(t,e,n,r,i,o){var u,a,c,s,f,h,l,p=d.BYTES_PER_ELEMENT;return"string"==typeof t&&(t=v.getAttribLocation(v.program,t)),n=n||0,r=r||0,i=(i=i||v.FLOAT)||v.FLOAT,a=t,c=e,s=i,f=n*p,h=r*p,l=o,(u=v).vertexAttribPointer(a,c,s,l||!1,f||0,h||0),u.enableVertexAttribArray(a),g},close:function(){var t;return t=i,v.deleteBuffer(t),a}};return g},texture:function(t,s){s=s||v.TEXTURE_2D;var e,n,r,i,o=(n=t,r=s,i=(e=v).createTexture(),e.activeTexture(e["TEXTURE"+n]),e.bindTexture(r,i),i),f={config:function(t){return function(t,e,n){var r;for(r in n)t.texParameteri(e,t[r],t[n[r]])}(v,s,t),f},use:function(t,e,n,r){var i,o,u,a,c;return i=s,o=t,u=e,a=n,c=r,v.texImage2D(i,o,u,u,a,c),f},close:function(){var t;return t=o,v.deleteTexture(t),a}};return f}};return a},t.clay=t.$$=y,y});