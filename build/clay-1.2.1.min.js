/*!
*
* clay - Provide more flexible data visualization solutions!
* git+https://github.com/yelloxing/clay.git
* 
* author 心叶
*
* version 1.2.1
* 
* build Sun Jul 29 2018
*
* Copyright yelloxing
* Released under the MIT license
* 
* Date:Sun Sep 09 2018 22:07:04 GMT+0800 (CST)
*/

!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e(t):e(t)}("undefined"!=typeof window?window:this,function(t,i){"use strict";var w=function(t,e){return new w.prototype.init(t,e)};w.prototype.init=function(e,t){if("function"==typeof e)w.__isLoad__?e():document.addEventListener?document.addEventListener("DOMContentLoaded",function t(){document.removeEventListener("DOMContentLoaded",t,!1),e(),w.__isLoad__=!0}):document.attachEvent&&document.attachEvent("onreadystatechange",function t(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",t),e(),w.__isLoad__=!0)});else{this.context=t=t||document;var r,n=u(e,t);for(r=0;r<n.length;r++)this[r]=n[r];this.length=n.length}return this},w.prototype.init.prototype=w.prototype;var a={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},y={whitespace:"[\\x20\\t\\r\\n\\f]",identifier:"(?:\\\\.|[\\w-]|[^\0-\\xa0])+"};w.math={},w.scale={},w.svg={},w.canvas={},w.webgl={},w.layout={};var o=["href","title","show","type","role","actuate"];function u(t,e){var r,n=[];if("string"!=typeof t){if(!t||1!==t.nodeType&&11!==t.nodeType&&9!==t.nodeType){if(!t||t.constructor!==Array&&t.constructor!==HTMLCollection&&t.constructor!==NodeList)return t&&t.constructor===w?t:[];for(r=0;r<t.length;r++)!t[r]||1!==t[r].nodeType&&11!==t[r].nodeType&&9!==t[r].nodeType||n.push(t[r]);return n}return[t]}if("*"===(t=(t+"").trim().replace(/[\n\f\r]/g,"")))return e.getElementsByTagName("*");var o=y.whitespace,i=y.identifier,a="\\["+o+"{0,}"+i+"(?:"+o+"{0,}="+o+"{0,}(\\'|\\\"){0,1}"+i+"\\1{0,1}){0,1}"+o+"{0,}\\]";if(new RegExp("^(?:"+i+"){0,1}(?:(?:#|\\.)"+i+"|"+a+"){0,}$").test(t)){var u,s=t.match(new RegExp("#"+i,"g")),f=t.match(new RegExp("\\."+i,"g")),h=t.match(new RegExp("^"+i)),c=t.match(new RegExp(a,"g"));if(s){if(1<s.length)return[];u=(u=document.getElementById((s.shift(0)+"").replace(/^#/,"")))?[u]:[]}else u=e.getElementsByClassName&&f?e.getElementsByClassName((f.shift(0)+"").replace(/^\./,"")):h?e.getElementsByTagName(h.shift(0)):e.getElementsByTagName("*");var d,p,l,m,g=new RegExp("^\\["+o+"{0,}("+i+")(?:"+o+"{0,}="+o+"{0,}(?:\\'|\\\"){0,1}("+i+")(?:\\'|\\\"){0,1}){0,1}"+o+"{0,}\\]$");for(r=0;r<u.length;r++)if(m=!0,!(h&&0<h.length&&(h[0]+"").toUpperCase()!==(u[r].tagName+"").toUpperCase())){for(d=" "+u[r].getAttribute("class")+" ",p=0;m&&f&&p<f.length;p++)if(d.search(" "+(f[p]+"").replace(/\./,"")+" ")<0){m=!1;break}for(p=0;m&&c&&p<c.length;p++)if(d=g.exec(c[p]),null===(l=u[r].getAttribute(d[1]))||d[2]&&l!=d[2]){m=!1;break}m&&n.push(u[r])}return n}try{return[v(t)]}catch(t){return[]}}function v(t){var e=document.createElementNS(a.svg,"svg");new RegExp("^"+y.identifier+"$").test(t)&&(t="<"+t+"></"+t+">"),e.innerHTML=t;var r,n,o=e.childNodes;for(r=0;r<o.length;r++)if(1===o[r].nodeType||9===o[r].nodeType||11===o[r].nodeType){n=o[r];break}if(/[A-Z]/.test(n.tagName))for((e=document.createElement("div")).innerHTML=t,o=e.childNodes,r=0;r<o.length;r++)if(1===o[r].nodeType||9===o[r].nodeType||11===o[r].nodeType){n=o[r];break}return n}w.prototype.find=function(t){if(this.length<=0)return w();var e,r=w(),n=u(t,this[0]);for(e=0;e<n.length;e++)r[e]=n[e],r.length+=1;return r},w.prototype.eq=function(t){return this.length<=t?new w:new w(this[t])},w.prototype.appendTo=function(t){var e,r,n=w(t);for(e=0;e<n.length;e++)for(r=0;r<this.length;r++)n[e].appendChild(this[r]);return this},w.prototype.remove=function(){var t;for(t=0;t<this.length;t++)this[t].parentNode.removeChild(this[t]);return this},w.prototype.attr=function(t,e){if(null==e||e==i)return 0<this.length?this[0].getAttribute(t):i;var r,n;for(r=0;r<this.length;r++)n="function"==typeof e?e(this[r]._data,r):e,/[A-Z]/.test(this[r].tagName)&&0<=o.indexOf(t)?this[r].setAttributeNS(a.xlink,"xlink:"+t,n):this[r].setAttribute(t,n);return this},w.prototype.css=function(t,e){if(arguments.length<=1&&"object"!=typeof t){if(this.length<1)return i;var r=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(this[0],null):this[0].currentStyle;return"string"==typeof t?r.getPropertyValue(t):r}var n,o;if(0<this.length)if("object"==typeof t)for(o in t)for(n=0;n<this.length;n++)this[n].style[o]="function"==typeof e?e(this[n]._data,n,o,t[o]):t[o];else for(n=0;n<this.length;n++)this[n].style[t]="function"==typeof e?e(this[n]._data,n):e;return this},w.prototype.datum=function(t,e){if(null===t||t===i)return 0<this.length?this[0]._data:i;var r;for(t="function"==typeof e?e(t):t,r=0;r<this.length;r++)this[r]._data=t;return this},w.prototype.data=function(t,e){var r,n=[];if(t&&t.constructor===Array){var o=w();for(r=0;r<t.length&&r<this.length;r++)this[r]._data="function"==typeof e?e(t[r]):t[r],o[r]=this[r],o.length+=1;for(o._enter=[];r<t.length;r++)o._enter.push("function"==typeof e?e(t[r]):t[r]);for(o._exit=[];r<this.length;r++)o._exit.push(this[r]);return o}for(r=0;r<this.length;r++)n[r]=this[r]._data;return n},w.prototype.enter=function(t){var e,r,n=w();for(e=0;this._enter&&e<this._enter.length;e++)(r=v(t))._data=this._enter[e],n[e]=r,n.length+=1;return delete this._enter,n},w.prototype.exit=function(){var t,e=w();for(t=0;this._exit&&t<this._exit.length;t++)e[t]=this._exit[t],e.length+=1;return delete this._exit,e};var s={timers:[],interval:13,speeds:400,timerId:null};w.animation=function(e,t,r){s.timer(function(t){e(t)},t,r)},s.timer=function(t,e,r){if("function"!=typeof t)throw new Error("tick is required!");(e="number"==typeof e?e:s.speeds)<0&&(e=-e),s.timers.push({createTime:new Date,tick:t,duration:e,callback:r}),s.start()},s.start=function(){s.timerId||(s.timerId=setInterval(s.tick,s.interval))},s.tick=function(){var t,e,r,n,o,i,a,u=s.timers;for(s.timers=[],e=s.timers.length=0;e<u.length;e++)t=(o=u[e]).createTime,r=o.tick,i=o.duration,n=o.callback,!1,1<=(a=(+new Date-t)/i)&&!0,r(a=1<a?1:a),a<1?s.timers.push(o):n&&n();s.timers.length<=0&&s.stop()},s.stop=function(){s.timerId&&(clearInterval(s.timerId),s.timerId=null)},w.color=function(t){var e=w("head").css("color",t).css("color").replace(/^rgba?\(([^)]+)\)$/,"$1").split(new RegExp("\\,"+y.whitespace));return[+e[0],+e[1],+e[2],e[3]==i?1:+e[3]]},w.getColors=function(t){if("number"==typeof t&&3<t){var e=[],r=0;for(r=1;r<=t;r++)e.push("rgb("+(230*Math.random(1)+20)+","+(230*Math.random(1)+20)+","+(230*Math.random(1)+20)+")");return e}return["rgb(255,0,0)","rgb(0,255,0)","rgb(0,0,255)"]},w.max=function(t,e){e="function"==typeof e?e:function(t){return t};for(var r,n=1,o=t[0],i=e(t[0],0);n<t.length;n++)i<(r=e(t[n],n))&&(o=t[n],i=r);return o},w.min=function(t,e){e="function"==typeof e?e:function(t){return t};for(var r,n=1,o=t[0],i=e(t[0],0);n<t.length;n++)(r=e(t[n],n))<i&&(o=t[n],i=r);return o},w.scale.linear=function(){var e={},r=function(t){if("number"!=typeof t)throw new Error("A number is required!");if(e.scaleCalc)return t<=e.domains[0]?e.ranges[0]:t>=e.domains[1]?e.ranges[1]:(t-e.domains[0])*e.scaleCalc+e.ranges[0];throw new Error("You shoud first set the domain and range!")};return r.getDomain=function(t){if("number"!=typeof t)throw new Error("A number is required!");if(e.scaleCalc)return t<=e.ranges[0]?e.domains[0]:t>=e.ranges[1]?e.domains[1]:(t-e.ranges[0])/e.scaleCalc+e.domains[0];throw new Error("You shoud first set the domain and range!")},r.domain=function(t){return t.constructor===Array&&2<=t.length?(e.domains=t,e.ranges&&(e.scaleCalc=(e.ranges[1]-e.ranges[0])/(e.domains[1]-e.domains[0])),r):e.domains},r.range=function(t){return t.constructor===Array&&2<=t.length?(e.ranges=t,e.domains&&(e.scaleCalc=(e.ranges[1]-e.ranges[0])/(e.domains[1]-e.domains[0])),r):e.ranges},r},w.math.hermite=function(){var s={u:.5},f=function(t){if(s.MR){var e=(t-s.a)/(s.b-s.a),r=e*e;return(e*r*s.MR[0]+r*s.MR[1]+e*s.MR[2]+s.MR[3])*(s.b-s.a)}throw new Error("You shoud first set the position!")};return f.setU=function(t){if("number"!=typeof t)throw new Error("Unsupported data!");return s.u=.5*(1-t),f},f.setP=function(t,e,r,n,o,i){if(!(t<r))throw new Error("Unsupported data!");s.a=t,s.b=r;var a=s.u*o,u=s.u*i;return e/=r-t,n/=r-t,s.MR=[2*e-2*n+a+u,3*n-3*e-2*a-u,a,e],f},f},w.math.cardinal=function(){var e,o={t:0},i=function(t){if(o.hs){for(e=-1;e+1<o.hs.x.length&&(t>o.hs.x[e+1]||-1==e&&t>=o.hs.x[e+1]);)e+=1;if(-1==e||e>=o.hs.h.length)throw new Error("Coordinate crossing!");return o.hs.h[e](t)}throw new Error("You shoud first set the position!")};return i.setU=function(t){if("number"!=typeof t)throw new Error("Unsupported data!");return o.t=t,i},i.setP=function(t){o.hs={x:[],h:[]};var e,r,n=(t[1][1]-t[0][1])/(t[1][0]-t[0][0]);for(o.hs.x[0]=t[0][0],e=1;e<t.length;e++){if(t[e][0]<=t[e-1][0])throw new Error("The point position should be increamented!");o.hs.x[e]=t[e][0],r=e<t.length-1?(t[e+1][1]-t[e-1][1])/(t[e+1][0]-t[e-1][0]):(t[e][1]-t[e-1][1])/(t[e][0]-t[e-1][0]),o.hs.h[e-1]=w.math.hermite().setU(o.t).setP(t[e-1][0],t[e-1][1],t[e][0],t[e][1],n,r),n=r}return i},i},w.math.rotate=function(){var l={},m=function(t,e){if(l.M&&l.P){if("number"!=typeof t)throw new Error("Unsupported data!");var r=l.M.A[0][0]*l.P[0]+l.M.A[0][1]*l.P[1]+l.M.A[0][2]*l.P[2]+l.M.A[0][3],n=l.M.A[1][0]*l.P[0]+l.M.A[1][1]*l.P[1]+l.M.A[1][2]*l.P[2]+l.M.A[1][3],o=l.M.A[2][0]*l.P[0]+l.M.A[2][1]*l.P[1]+l.M.A[2][2]*l.P[2]+l.M.A[2][3],i=Math.cos(t),a=Math.sin(t),u=r*i-n*a;n=r*a+n*i,r=u;var s=[l.M.B[0][0]*r+l.M.B[0][1]*n+l.M.B[0][2]*o+l.M.B[0][3],l.M.B[1][0]*r+l.M.B[1][1]*n+l.M.B[1][2]*o+l.M.B[1][3],l.M.B[2][0]*r+l.M.B[2][1]*n+l.M.B[2][2]*o+l.M.B[2][3]];return s[0]=Math.round(1e14*s[0])/1e14,s[1]=Math.round(1e14*s[1])/1e14,s[2]=Math.round(1e14*s[2])/1e14,e?(l.P=s,m):s}throw new Error("You shoud first set the ray and position!")};return m.setL=function(t,e,r,n,o,i){if("number"!=typeof t||"number"!=typeof e)throw new Error("a1 and b1 is required!");if("number"!=typeof r?(r=0,n=t,o=e,i=1):"number"==typeof n&&"number"==typeof o&&"number"==typeof i||(n=t,o=e,i=r,r=e=t=0),t==n&&e==o&&r==i)throw new Error("It's not a legitimate ray!");var a=Math.sqrt((n-t)*(n-t)+(o-e)*(o-e)),u=0!=a?(o-e)/a:1,s=0!=a?(n-t)/a:0,f=(n-t)*s+(o-e)*u,h=i-r,c=Math.sqrt(f*f+h*h),d=0!=c?h/c:1,p=0!=c?f/c:0;return l.M={A:[[u,-s,0,e*s-t*u],[d*s,u*d,-p,r*p-t*s*d-e*u*d],[s*p,u*p,d,-t*s*p-e*u*p-r*d]],B:[[u,d*s,s*p,t],[-s,d*u,u*p,e],[0,-p,d,r]]},m},m.setP=function(t,e,r){if("number"!=typeof t||"number"!=typeof e)throw new Error("Unsupported data!");return"number"!=typeof r&&(r=0),l.P=[t,e,r],m},m},w.math.move=function(){var o={},i=function(t,e){if(o.D&&o.P){if("number"!=typeof t)throw new Error("Unsupported data!");var r=[o.D[0]*t+o.P[0],o.D[1]*t+o.P[1],o.D[2]*t+o.P[2]];return e?(o.P=r,i):r}throw new Error("You shoud first set the direction and position!")};return i.setP=function(t,e,r){if("number"!=typeof t||"number"!=typeof e)throw new Error("Unsupported data!");return"number"!=typeof r&&(r=0),o.P=[t,e,r],i},i.setD=function(t,e,r){if("number"!=typeof t||"number"!=typeof e)throw new Error("Unsupported data!");if("number"!=typeof r&&(r=0),0==t&&0==e&&0==r)o.D=[0,0,0];else{var n=Math.sqrt(t*t+e*e+r*r);o.D=[t/n,e/n,r/n]}return i},i},w.math.scale=function(){var n={C:[0,0,0]},o=function(t,e){if(n.P){if("number"!=typeof t)throw new Error("Unsupported data!");var r=[t*(n.P[0]-n.C[0])+n.C[0],t*(n.P[1]-n.C[1])+n.C[1],t*(n.P[2]-n.C[2])+n.C[2]];return e?(n.P=r,o):r}throw new Error("You shoud first set the position!")};return o.setC=function(t,e,r){if("number"!=typeof t||"number"!=typeof e)throw new Error("Unsupported data!");return"number"!=typeof r&&(r=0),n.C=[t,e,r],o},o.setP=function(t,e,r){if("number"!=typeof t||"number"!=typeof e)throw new Error("Unsupported data!");return"number"!=typeof r&&(r=0),n.P=[t,e,r],o},o};var f=function(i){var a={interpolate:"line",dis:5,t:0},e=function(t,e){if("number"!=typeof a.h)throw new Error("You need to set the height first!");var r,n,o=i.init(t[0][0],e?t[0][1]:a.h-t[0][1]);if("cardinal"===a.interpolate)for(r=w.math.cardinal().setU(a.t).setP(t),n=t[0][0]+a.dis;n<t[t.length-1][0];n+=a.dis)o=i.draw(o,n,e?r(n):a.h-r(n));else for(n=1;n<t.length;n++)o=i.draw(o,t[n][0],e?t[n][1]:a.h-t[n][1]);return i.end(o)};return e.setHeight=function(t){if("number"!=typeof t||t<=0)throw new Error("Unsupported data!");return a.h=t,e},e.setT=function(t){if("number"!=typeof t)throw new Error("Unsupported data!");return a.t=t,e},e.setPrecision=function(t){if("number"!=typeof t)throw new Error("Unsupported data!");return a.dis=t,e},e.interpolate=function(t){return a.interpolate=t,e},e};return w.svg.line=function(){return f({init:function(t,e){return"M"+t+" "+e+"L"},draw:function(t,e,r){return t+""+e+" "+r+","},end:function(t){return t.replace(/,$/,"")}})},w.canvas.line=function(t,e){e=e||{};var r,n=t&&t.constructor===CanvasRenderingContext2D?t:w(t)[0].getContext("2d"),o=f({init:function(t,e){return n.moveTo(t,e),n},draw:function(t,e,r){return t.lineTo(e,r),t},end:function(t){for(r in e)t[r]=e[r];return t.stroke(),t}});return o.canvas=function(t){return n=t&&t.constructor===CanvasRenderingContext2D?t:w(t)[0].getContext("2d"),o},o.config=function(t){for(r in t)e[r]=t[r];return o},o},w.__isLoad__=!1,w.author="心叶",w.email="yelloxing@gmail.com",w.version="1.2.1",t.clay=t.$$=w,w});