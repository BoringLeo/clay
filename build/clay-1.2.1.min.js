/*!
*
* clay - Provide more flexible data visualization solutions!
* git+https://github.com/yelloxing/clay.git
* 
* author 心叶
*
* version 1.2.1
* 
* build Sun Jul 29 2018
*
* Copyright yelloxing
* Released under the MIT license
* 
* Date:Sat Sep 15 2018 12:31:27 GMT+0800 (CST)
*/

!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e(t):e(t)}("undefined"!=typeof window?window:this,function(t,i){"use strict";var y=function(t,e){return new y.prototype.init(t,e)};y.prototype.init=function(e,t){if("function"==typeof e)y.__isLoad__?e():document.addEventListener?document.addEventListener("DOMContentLoaded",function t(){document.removeEventListener("DOMContentLoaded",t,!1),e(),y.__isLoad__=!0}):document.attachEvent&&document.attachEvent("onreadystatechange",function t(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",t),e(),y.__isLoad__=!0)});else{this.context=t=t||document;var n,r=u(e,t);for(n=0;n<r.length;n++)this[n]=r[n];this.length=r.length}return this},y.prototype.init.prototype=y.prototype;var a={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},w={whitespace:"[\\x20\\t\\r\\n\\f]",identifier:"(?:\\\\.|[\\w-]|[^\0-\\xa0])+"};y.math={},y.scale={},y.svg={},y.canvas={},y.webgl={},y.layout={};var o=["href","title","show","type","role","actuate"],l=8988e6;function u(t,e){var n,r=[];if("string"!=typeof t){if(!t||1!==t.nodeType&&11!==t.nodeType&&9!==t.nodeType){if(!t||t.constructor!==Array&&t.constructor!==HTMLCollection&&t.constructor!==NodeList)return t&&t.constructor===y?t:[];for(n=0;n<t.length;n++)!t[n]||1!==t[n].nodeType&&11!==t[n].nodeType&&9!==t[n].nodeType||r.push(t[n]);return r}return[t]}if("*"===(t=(t+"").trim().replace(/[\n\f\r]/g,"")))return e.getElementsByTagName("*");var o=w.whitespace,i=w.identifier,a="\\["+o+"{0,}"+i+"(?:"+o+"{0,}="+o+"{0,}(\\'|\\\"){0,1}"+i+"\\1{0,1}){0,1}"+o+"{0,}\\]";if(new RegExp("^(?:"+i+"){0,1}(?:(?:#|\\.)"+i+"|"+a+"){0,}$").test(t)){var u,f=t.match(new RegExp("#"+i,"g")),s=t.match(new RegExp("\\."+i,"g")),h=t.match(new RegExp("^"+i)),c=t.match(new RegExp(a,"g"));if(f){if(1<f.length)return[];u=(u=document.getElementById((f.shift(0)+"").replace(/^#/,"")))?[u]:[]}else u=e.getElementsByClassName&&s?e.getElementsByClassName((s.shift(0)+"").replace(/^\./,"")):h?e.getElementsByTagName(h.shift(0)):e.getElementsByTagName("*");var l,p,d,g,m=new RegExp("^\\["+o+"{0,}("+i+")(?:"+o+"{0,}="+o+"{0,}(?:\\'|\\\"){0,1}("+i+")(?:\\'|\\\"){0,1}){0,1}"+o+"{0,}\\]$");for(n=0;n<u.length;n++)if(g=!0,!(h&&0<h.length&&(h[0]+"").toUpperCase()!==(u[n].tagName+"").toUpperCase())){for(l=" "+u[n].getAttribute("class")+" ",p=0;g&&s&&p<s.length;p++)if(l.search(" "+(s[p]+"").replace(/\./,"")+" ")<0){g=!1;break}for(p=0;g&&c&&p<c.length;p++)if(l=m.exec(c[p]),null===(d=u[n].getAttribute(l[1]))||l[2]&&d!=l[2]){g=!1;break}g&&r.push(u[n])}return r}try{return[v(t)]}catch(t){return[]}}function v(t){var e=document.createElementNS(a.svg,"svg");new RegExp("^"+w.identifier+"$").test(t)&&(t="<"+t+"></"+t+">"),e.innerHTML=t;var n,r,o=e.childNodes;for(n=0;n<o.length;n++)if(1===o[n].nodeType||9===o[n].nodeType||11===o[n].nodeType){r=o[n];break}if(/[A-Z]/.test(r.tagName))for((e=document.createElement("div")).innerHTML=t,o=e.childNodes,n=0;n<o.length;n++)if(1===o[n].nodeType||9===o[n].nodeType||11===o[n].nodeType){r=o[n];break}return r}y.prototype.find=function(t){if(this.length<=0)return y();var e,n=y(),r=u(t,this[0]);for(e=0;e<r.length;e++)n[e]=r[e],n.length+=1;return n},y.prototype.eq=function(t){return this.length<=t?new y:new y(this[t])},y.prototype.appendTo=function(t){var e,n,r=y(t);for(e=0;e<r.length;e++)for(n=0;n<this.length;n++)r[e].appendChild(this[n]);return this},y.prototype.remove=function(){var t;for(t=0;t<this.length;t++)this[t].parentNode.removeChild(this[t]);return this},y.prototype.attr=function(t,e){if(null==e||e==i)return 0<this.length?this[0].getAttribute(t):i;var n,r;for(n=0;n<this.length;n++)r="function"==typeof e?e(this[n]._data,n):e,/[A-Z]/.test(this[n].tagName)&&0<=o.indexOf(t)?this[n].setAttributeNS(a.xlink,"xlink:"+t,r):this[n].setAttribute(t,r);return this},y.prototype.css=function(t,e){if(arguments.length<=1&&"object"!=typeof t){if(this.length<1)return i;var n=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(this[0],null):this[0].currentStyle;return"string"==typeof t?n.getPropertyValue(t):n}var r,o;if(0<this.length)if("object"==typeof t)for(o in t)for(r=0;r<this.length;r++)this[r].style[o]="function"==typeof e?e(this[r]._data,r,o,t[o]):t[o];else for(r=0;r<this.length;r++)this[r].style[t]="function"==typeof e?e(this[r]._data,r):e;return this},y.prototype.datum=function(t,e){if(null===t||t===i)return 0<this.length?this[0]._data:i;var n;for(t="function"==typeof e?e(t):t,n=0;n<this.length;n++)this[n]._data=t;return this},y.prototype.data=function(t,e){var n,r=[];if(t&&t.constructor===Array){var o=y();for(n=0;n<t.length&&n<this.length;n++)this[n]._data="function"==typeof e?e(t[n]):t[n],o[n]=this[n],o.length+=1;for(o._enter=[];n<t.length;n++)o._enter.push("function"==typeof e?e(t[n]):t[n]);for(o._exit=[];n<this.length;n++)o._exit.push(this[n]);return o}for(n=0;n<this.length;n++)r[n]=this[n]._data;return r},y.prototype.enter=function(t){var e,n,r=y();for(e=0;this._enter&&e<this._enter.length;e++)(n=v(t))._data=this._enter[e],r[e]=n,r.length+=1;return delete this._enter,r},y.prototype.exit=function(){var t,e=y();for(t=0;this._exit&&t<this._exit.length;t++)e[t]=this._exit[t],e.length+=1;return delete this._exit,e};var f={timers:[],interval:13,speeds:400,timerId:null};y.animation=function(e,t,n){f.timer(function(t){e(t)},t,n)},f.timer=function(t,e,n){if("function"!=typeof t)throw new Error("tick is required!");(e="number"==typeof e?e:f.speeds)<0&&(e=-e),f.timers.push({createTime:new Date,tick:t,duration:e,callback:n}),f.start()},f.start=function(){f.timerId||(f.timerId=setInterval(f.tick,f.interval))},f.tick=function(){var t,e,n,r,o,i,a,u=f.timers;for(f.timers=[],e=f.timers.length=0;e<u.length;e++)t=(o=u[e]).createTime,n=o.tick,i=o.duration,r=o.callback,!1,1<=(a=(+new Date-t)/i)&&!0,n(a=1<a?1:a),a<1?f.timers.push(o):r&&r();f.timers.length<=0&&f.stop()},f.stop=function(){f.timerId&&(clearInterval(f.timerId),f.timerId=null)},y.color=function(t){var e=y("head").css("color",t).css("color").replace(/^rgba?\(([^)]+)\)$/,"$1").split(new RegExp("\\,"+w.whitespace));return[+e[0],+e[1],+e[2],e[3]==i?1:+e[3]]},y.getColors=function(t){if("number"==typeof t&&3<t){var e=[],n=0;for(n=1;n<=t;n++)e.push("rgb("+(230*Math.random(1)+20)+","+(230*Math.random(1)+20)+","+(230*Math.random(1)+20)+")");return e}return["rgb(255,0,0)","rgb(0,255,0)","rgb(0,0,255)"]},y.max=function(t,e){e="function"==typeof e?e:function(t){return t};for(var n,r=1,o=t[0],i=e(t[0],0);r<t.length;r++)i<(n=e(t[r],r))&&(o=t[r],i=n);return o},y.min=function(t,e){e="function"==typeof e?e:function(t){return t};for(var n,r=1,o=t[0],i=e(t[0],0);r<t.length;r++)(n=e(t[r],r))<i&&(o=t[r],i=n);return o},y.scale.linear=function(){var e={},n=function(t){if("number"!=typeof t)throw new Error("A number is required!");if(e.scaleCalc)return t<=e.domains[0]?e.ranges[0]:t>=e.domains[1]?e.ranges[1]:(t-e.domains[0])*e.scaleCalc+e.ranges[0];throw new Error("You shoud first set the domain and range!")};return n.getDomain=function(t){if("number"!=typeof t)throw new Error("A number is required!");if(e.scaleCalc)return t<=e.ranges[0]?e.domains[0]:t>=e.ranges[1]?e.domains[1]:(t-e.ranges[0])/e.scaleCalc+e.domains[0];throw new Error("You shoud first set the domain and range!")},n.domain=function(t){return t.constructor===Array&&2<=t.length?(e.domains=t,e.ranges&&(e.scaleCalc=(e.ranges[1]-e.ranges[0])/(e.domains[1]-e.domains[0])),n):e.domains},n.range=function(t){return t.constructor===Array&&2<=t.length?(e.ranges=t,e.domains&&(e.scaleCalc=(e.ranges[1]-e.ranges[0])/(e.domains[1]-e.domains[0])),n):e.ranges},n},y.math.hermite=function(){var f={u:.5},s=function(t){if(f.MR){var e=(t-f.a)/(f.b-f.a),n=e*e;return(e*n*f.MR[0]+n*f.MR[1]+e*f.MR[2]+f.MR[3])*(f.b-f.a)}throw new Error("You shoud first set the position!")};return s.setU=function(t){if("number"!=typeof t)throw new Error("Unsupported data!");return f.u=.5*(1-t),s},s.setP=function(t,e,n,r,o,i){if(!(t<n))throw new Error("Unsupported data!");f.a=t,f.b=n;var a=f.u*o,u=f.u*i;return e/=n-t,r/=n-t,f.MR=[2*e-2*r+a+u,3*r-3*e-2*a-u,a,e],s},s},y.math.cardinal=function(){var e,o={t:0},i=function(t){if(o.hs){for(e=-1;e+1<o.hs.x.length&&(t>o.hs.x[e+1]||-1==e&&t>=o.hs.x[e+1]);)e+=1;if(-1==e||e>=o.hs.h.length)throw new Error("Coordinate crossing!");return o.hs.h[e](t)}throw new Error("You shoud first set the position!")};return i.setU=function(t){if("number"!=typeof t)throw new Error("Unsupported data!");return o.t=t,i},i.setP=function(t){o.hs={x:[],h:[]};var e,n,r=(t[1][1]-t[0][1])/(t[1][0]-t[0][0]);for(o.hs.x[0]=t[0][0],e=1;e<t.length;e++){if(t[e][0]<=t[e-1][0])throw new Error("The point position should be increamented!");o.hs.x[e]=t[e][0],n=e<t.length-1?(t[e+1][1]-t[e-1][1])/(t[e+1][0]-t[e-1][0]):(t[e][1]-t[e-1][1])/(t[e][0]-t[e-1][0]),o.hs.h[e-1]=y.math.hermite().setU(o.t).setP(t[e-1][0],t[e-1][1],t[e][0],t[e][1],r,n),r=n}return i},i},y.math.rotate=function(){var d={},g=function(t,e){if(d.M&&d.P){if("number"!=typeof t)throw new Error("Unsupported data!");var n=d.M.A[0][0]*d.P[0]+d.M.A[0][1]*d.P[1]+d.M.A[0][2]*d.P[2]+d.M.A[0][3],r=d.M.A[1][0]*d.P[0]+d.M.A[1][1]*d.P[1]+d.M.A[1][2]*d.P[2]+d.M.A[1][3],o=d.M.A[2][0]*d.P[0]+d.M.A[2][1]*d.P[1]+d.M.A[2][2]*d.P[2]+d.M.A[2][3],i=Math.cos(t),a=Math.sin(t),u=n*i-r*a;r=n*a+r*i,n=u;var f=[d.M.B[0][0]*n+d.M.B[0][1]*r+d.M.B[0][2]*o+d.M.B[0][3],d.M.B[1][0]*n+d.M.B[1][1]*r+d.M.B[1][2]*o+d.M.B[1][3],d.M.B[2][0]*n+d.M.B[2][1]*r+d.M.B[2][2]*o+d.M.B[2][3]];return f[0]=Math.round(1e14*f[0])/1e14,f[1]=Math.round(1e14*f[1])/1e14,f[2]=Math.round(1e14*f[2])/1e14,e&&(d.P=f),f}throw new Error("You shoud first set the ray and position!")};return g.setL=function(t,e,n,r,o,i){if("number"!=typeof t||"number"!=typeof e)throw new Error("a1 and b1 is required!");if("number"!=typeof n?(n=0,r=t,o=e,i=1):"number"==typeof r&&"number"==typeof o&&"number"==typeof i||(r=t,o=e,i=n,n=e=t=0),t==r&&e==o&&n==i)throw new Error("It's not a legitimate ray!");var a=Math.sqrt((r-t)*(r-t)+(o-e)*(o-e)),u=0!=a?(o-e)/a:1,f=0!=a?(r-t)/a:0,s=(r-t)*f+(o-e)*u,h=i-n,c=Math.sqrt(s*s+h*h),l=0!=c?h/c:1,p=0!=c?s/c:0;return d.M={A:[[u,-f,0,e*f-t*u],[l*f,u*l,-p,n*p-t*f*l-e*u*l],[f*p,u*p,l,-t*f*p-e*u*p-n*l]],B:[[u,l*f,f*p,t],[-f,l*u,u*p,e],[0,-p,l,n]]},g},g.setP=function(t,e,n){if("number"!=typeof t||"number"!=typeof e)throw new Error("Unsupported data!");return"number"!=typeof n&&(n=0),d.P=[t,e,n],g},g},y.math.move=function(){var o={},i=function(t,e){if(o.D&&o.P){if("number"!=typeof t)throw new Error("Unsupported data!");var n=[o.D[0]*t+o.P[0],o.D[1]*t+o.P[1],o.D[2]*t+o.P[2]];return e&&(o.P=n),n}throw new Error("You shoud first set the direction and position!")};return i.setP=function(t,e,n){if("number"!=typeof t||"number"!=typeof e)throw new Error("Unsupported data!");return"number"!=typeof n&&(n=0),o.P=[t,e,n],i},i.setD=function(t,e,n){if("number"!=typeof t||"number"!=typeof e)throw new Error("Unsupported data!");if("number"!=typeof n&&(n=0),0==t&&0==e&&0==n)o.D=[0,0,0];else{var r=Math.sqrt(t*t+e*e+n*n);o.D=[t/r,e/r,n/r]}return i},i},y.math.scale=function(){var r={C:[0,0,0]},o=function(t,e){if(r.P){if("number"!=typeof t)throw new Error("Unsupported data!");var n=[t*(r.P[0]-r.C[0])+r.C[0],t*(r.P[1]-r.C[1])+r.C[1],t*(r.P[2]-r.C[2])+r.C[2]];return e&&(r.P=n),n}throw new Error("You shoud first set the position!")};return o.setC=function(t,e,n){if("number"!=typeof t||"number"!=typeof e)throw new Error("Unsupported data!");return"number"!=typeof n&&(n=0),r.C=[t,e,n],o},o.setP=function(t,e,n){if("number"!=typeof t||"number"!=typeof e)throw new Error("Unsupported data!");return"number"!=typeof n&&(n=0),r.P=[t,e,n],o},o};function s(t){if(t&&t.constructor===CanvasRenderingContext2D)return t;var e=y(t);return 0<e.length?e[0].getContext("2d"):void 0}y.layout.force=function(i,a){var s,h,c={e:{}},u=function(){var t,e,n,r,o;for(t=0;t<s.length;t++)s[t]._forceX=0,s[t]._forceY=0;for(function(){var t,e,n,r,o,i,a,u,f;for(i=0;i<s.length-1;i++)for(a=i+1;a<s.length;a++)t=s[a].x-s[i].x,e=s[a].y-s[i].y,0==t&&0==e||(n=t*t+e*e,r=Math.sqrt(n),u=(o=1e-4*l/n)*t/r,f=o*e/r,s[i]._forceX-=u,s[i]._forceY-=f,s[a]._forceX+=u,s[a]._forceY+=f)}(),function(){var t,e,n,r,o,i,a,u,f;for(t=0;t<h.length;t++)r=h[t].link[0],o=h[t].link[1],e=c.n[o].x-c.n[r].x,n=c.n[o].y-c.n[r].y,0==e&&0==n||(u=(a=1*((i=Math.sqrt(e*e+n*n))-h[t].length))*e/i,f=a*n/i,c.n[r]._forceX+=u,c.n[r]._forceY+=f,c.n[o]._forceX-=u,c.n[o]._forceY-=f)}(),t=0;t<s.length;t++)10<(r=(e=s[t]._forceX)*e+(n=s[t]._forceY)*n)&&(e*=o=Math.sqrt(10/r),n*=o),(s[t].x+e<0||s[t].x+e>i)&&(e=0),(s[t].y+n<0||s[t].y+n>a)&&(n=0),s[t].x+=e,s[t].y+=n;for(c.e.live&&"function"==typeof c.e.live[0]&&c.e.live[0](),t=0;t<h.length;t++)c.e.update[1](h[t],c.n[h[t].link[0]],c.n[h[t].link[1]]);for(t=0;t<s.length;t++)c.e.update[0](c.n[s[t].id]);c.e.live&&"function"==typeof c.e.live[1]&&c.e.live[1](),0<c._n_&&(c._n_-=1,window.setTimeout(function(){u()},40))},f=function(t,e){var n;for(c.n={},s=t,h=e,n=0;n<t.length;n++)c.n[t[n].id]=t[n],c.n[t[n].id]._link=[];for(n=0;n<e.length;n++)c.n[e[n].link[0]]._link.push({link:e[n].link[1],length:e[n].length}),c.n[e[n].link[1]]._link.push({link:e[n].link[0],length:e[n].length});var r=Math.ceil(i/Math.sqrt(i*a/t.length)),o=i/r;for(n=0;n<t.length;n++)c.n[t[n].id].x=n%r*o+.5*o,c.n[t[n].id].y=Math.ceil((n+1)/r)*o-.5*o;for(n=0;n<e.length;n++)c.e.init[1](e[n],c.n[e[n].link[0]],c.n[e[n].link[1]]);for(n=0;n<t.length;n++)c.e.init[0](c.n[t[n].id]);return c._n_=1e3,u(),f};return f.bind=function(t,e,n){return"function"!=typeof e&&(e=function(){}),"function"!=typeof n&&(n=function(){}),c.e[t]=[e,n],f},f};var h=function(t,e,n,r){var o,i=n(r);return i._config=e||{},i._painter=s(t),i.canvas=function(t){return i._painter=s(t),i},i.config=function(t){for(o in t)i._config[o]=t[o];return i},i},c=function(o){var i={interpolate:"line",dis:5,t:0,flag:!1},e=function(t){if("number"!=typeof i.h)throw new Error("You need to set the height first!");var e,n,r=o.init(t[0][0],i.flag?t[0][1]:i.h-t[0][1]);if("cardinal"===i.interpolate)for(e=y.math.cardinal().setU(i.t).setP(t),n=t[0][0]+i.dis;n<t[t.length-1][0];n+=i.dis)r=o.draw(r,n,i.flag?e(n):i.h-e(n));else for(n=1;n<t.length;n++)r=o.draw(r,t[n][0],i.flag?t[n][1]:i.h-t[n][1]);return o.end(r)};return e.setFlag=function(t){return i.flag=t,e},e.setHeight=function(t){if("number"!=typeof t||t<=0)throw new Error("Unsupported data!");return i.h=t,e},e.setT=function(t){if("number"!=typeof t)throw new Error("Unsupported data!");return i.t=t,e},e.setPrecision=function(t){if("number"!=typeof t)throw new Error("Unsupported data!");return i.dis=t,e},e.interpolate=function(t){return i.interpolate=t,e},e},n=function(a){var u={c:[0,0],r:[100,140]},f=y.math.rotate().setL(0,0),n=function(t,e,n,r){"number"!=typeof n&&(n=u.r[0]),"number"!=typeof r&&(r=u.r[1]);var o,i=[];return f.setP(u.c[0]+n,u.c[1]),o=f(t,!0),i[0]=o[0],i[1]=o[1],o=f(e),i[2]=o[0],i[3]=o[1],f.setP(u.c[0]+r,u.c[1]),o=f(t,!0),i[4]=o[0],i[5]=o[1],o=f(e),i[6]=o[0],i[7]=o[1],a(u.c[0],u.c[1],n,r,t,t+e,i[0],i[1],i[4],i[5],i[2],i[3],i[6],i[7])};return n.setRadius=function(t,e){if("number"!=typeof t||"number"!=typeof e)throw new Error("Unsupported data!");return u.r=[t,e],n},n.setCenter=function(t,e){if("number"!=typeof t||"number"!=typeof e)throw new Error("Unsupported data!");return f.setL(t,e),u.c=[t,e],n},n};return y.svg.arc=function(){return n(function(t,e,n,r,o,i,a,u,f,s,h,c,l,p){var d=i-o>Math.PI?1:0,g="M"+a+" "+u;return g+="A"+n+" "+n+" 0 "+d+" 1 "+h+" "+c,g+="L"+l+" "+p,g+="A"+r+" "+r+" 0 "+d+" 0 "+f+" "+s,g+="L"+a+" "+u})},y.svg.line=function(){return c({init:function(t,e){return"M"+t+" "+e+"L"},draw:function(t,e,n){return t+""+e+" "+n+","},end:function(t){return t.replace(/,$/,"")}})},y.canvas.arc=function(t,e){var d,g=h(t,e,n,function(t,e,n,r,o,i,a,u,f,s,h,c,l,p){for(d in g._painter.moveTo(a,u),g._painter.arc(t,e,n,o,i,!1),g._painter.lineTo(l,p),g._painter.arc(t,e,r,i,o,!0),g._painter.lineTo(a,u),g._config)g._painter[d]=g._config[d];return g._painter.fill(),g._painter});return g},y.canvas.line=function(t,e){var n,r=h(t,e,c,{init:function(t,e){return r._painter.moveTo(t,e),r._painter},draw:function(t,e,n){return t.lineTo(e,n),t},end:function(t){for(n in r._config)t[n]=r._config[n];return t.stroke(),t}});return r},y.__isLoad__=!1,y.author="心叶",y.email="yelloxing@gmail.com",y.version="1.2.1",t.clay=t.$$=y,y});