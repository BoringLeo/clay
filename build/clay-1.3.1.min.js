/*!
*
* clay - Provide more flexible data visualization solutions!
* git+https://github.com/yelloxing/clay.git
* 
* author 心叶
*
* version 1.3.1
* 
* build Sun Jul 29 2018
*
* Copyright yelloxing
* Released under the MIT license
* 
* Date:Wed Oct 31 2018 11:22:06 GMT+0800 (CST)
*/

!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e(t):e(t)}("undefined"!=typeof window?window:this,function(t,i){"use strict";var w=function(t,e){return new w.prototype.init(t,e)};w.prototype.init=function(t,e){this.context=e=e||document;var n,r=s(t,e);for(n=0;n<r.length;n++)this[n]=r[n];return this.selector=t,this.length=r.length,this},w.prototype.init.prototype=w.prototype;var h={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},m={whitespace:"[\\x20\\t\\r\\n\\f]",identifier:"(?:\\\\.|[\\w-]|[^\0-\\xa0])+"},o=["href","title","show","type","role","actuate"];function s(t,e){var n,r=[];if("string"!=typeof t){if(!t||1!==t.nodeType&&11!==t.nodeType&&9!==t.nodeType){if(!t||t.constructor!==Array&&t.constructor!==HTMLCollection&&t.constructor!==NodeList)return t&&t.constructor===w?t:[];for(n=0;n<t.length;n++)!t[n]||1!==t[n].nodeType&&11!==t[n].nodeType&&9!==t[n].nodeType||r.push(t[n]);return r}return[t]}if("*"===(t=(t+"").trim().replace(/[\n\f\r]/g,"")))return e.getElementsByTagName("*");var o=m.whitespace,i=m.identifier,h="\\["+o+"{0,}"+i+"(?:"+o+"{0,}="+o+"{0,}(\\'|\\\"){0,1}"+i+"\\1{0,1}){0,1}"+o+"{0,}\\]";if(new RegExp("^(?:"+i+"){0,1}(?:(?:#|\\.)"+i+"|"+h+"){0,}$").test(t)){var s,u=t.match(new RegExp("#"+i,"g")),a=t.match(new RegExp("\\."+i,"g")),f=t.match(new RegExp("^"+i)),l=t.match(new RegExp(h,"g"));if(u){if(1<u.length)return[];s=(s=document.getElementById((u.shift(0)+"").replace(/^#/,"")))?[s]:[]}else s=e.getElementsByClassName&&a?e.getElementsByClassName((a.shift(0)+"").replace(/^\./,"")):f?e.getElementsByTagName(f.shift(0)):e.getElementsByTagName("*");var p,c,g,d,y=new RegExp("^\\["+o+"{0,}("+i+")(?:"+o+"{0,}="+o+"{0,}(?:\\'|\\\"){0,1}("+i+")(?:\\'|\\\"){0,1}){0,1}"+o+"{0,}\\]$");for(n=0;n<s.length;n++)if(d=!0,!(f&&0<f.length&&(f[0]+"").toUpperCase()!==(s[n].tagName+"").toUpperCase())){for(p=" "+s[n].getAttribute("class")+" ",c=0;d&&a&&c<a.length;c++)if(p.search(" "+(a[c]+"").replace(/\./,"")+" ")<0){d=!1;break}for(c=0;d&&l&&c<l.length;c++)if(p=y.exec(l[c]),null===(g=s[n].getAttribute(p[1]))||p[2]&&g!=p[2]){d=!1;break}d&&r.push(s[n])}return r}try{return[v(t)]}catch(t){return[]}}function v(t){var e=document.createElementNS(h.svg,"svg");new RegExp("^"+m.identifier+"$").test(t)&&(t="<"+t+"></"+t+">"),e.innerHTML=t;var n,r,o=e.childNodes;for(n=0;n<o.length;n++)if(1===o[n].nodeType||9===o[n].nodeType||11===o[n].nodeType){r=o[n];break}if("canvas"==r.tagName||/[A-Z]/.test(r.tagName))for((e=document.createElement("div")).innerHTML=t,o=e.childNodes,n=0;n<o.length;n++)if(1===o[n].nodeType||9===o[n].nodeType||11===o[n].nodeType){r=o[n];break}return r}w.prototype.find=function(t){if(this.length<=0)return w();var e,n=w(),r=s(t,this[0]);for(n.selector=t,e=0;e<r.length;e++)n[e]=r[e],n.length+=1;return n},w.prototype.eq=function(t){return this.length<=t?new w:new w(this[t])},w.prototype.appendTo=function(t){var e,n,r=w(t);for(e=0;e<r.length;e++)for(n=0;n<this.length;n++)r[e].appendChild(this[n]);return this},w.prototype.remove=function(){var t;for(t=0;t<this.length;t++)this[t].parentNode.removeChild(this[t]);return this},w.prototype.refresh=function(){var t,e=s(this.selector,this.context),n=this.length;for(t=this.length=0;t<e.length;t++)this[t]=e[t],this.length+=1;for(;t<n;t++)delete this[t];return this},w.prototype.attr=function(t,e){if(null==e||e==i)return 0<this.length?this[0].getAttribute(t):i;var n,r;for(n=0;n<this.length;n++)r="function"==typeof e?e(this[n]._data,n,this.eq(n)):e,/[A-Z]/.test(this[n].tagName)&&0<=o.indexOf(t)?this[n].setAttributeNS(h.xlink,"xlink:"+t,r):this[n].setAttribute(t,r);return this},w.prototype.css=function(t,e){if(arguments.length<=1&&"object"!=typeof t){if(this.length<1)return i;var n=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(this[0],null):this[0].currentStyle;return"string"==typeof t?n.getPropertyValue(t):n}var r,o;if(0<this.length)if("object"==typeof t)for(o in t)for(r=0;r<this.length;r++)this[r].style[o]="function"==typeof e?e(this[r]._data,r,o,t[o]):t[o];else for(r=0;r<this.length;r++)this[r].style[t]="function"==typeof e?e(this[r]._data,r):e;return this},w.prototype.datum=function(t,e){if(null===t||t===i)return 0<this.length?this[0]._data:i;var n;for(t="function"==typeof e?e(t):t,n=0;n<this.length;n++)this[n]._data=t;return this},w.prototype.data=function(t,e){var n,r=[];if(t&&t.constructor===Array){var o=w();for(o.selector=this.selector,n=0;n<t.length&&n<this.length;n++)this[n]._data="function"==typeof e?e(t[n]):t[n],o[n]=this[n],o.length+=1;for(o._enter=[];n<t.length;n++)o._enter.push("function"==typeof e?e(t[n]):t[n]);for(o._exit=[];n<this.length;n++)o._exit.push(this[n]);return o}for(n=0;n<this.length;n++)r[n]=this[n]._data;return r},w.prototype.enter=function(t){var e,n,r=w();for(r.selector=this.selector,e=0;this._enter&&e<this._enter.length;e++)(n=v(t))._data=this._enter[e],r[e]=n,r.length+=1;return delete this._enter,r},w.prototype.exit=function(){var t,e=w();for(e.selector=this.selector,t=0;this._exit&&t<this._exit.length;t++)e[t]=this._exit[t],e.length+=1;return delete this._exit,e},w.prototype.bind=function(t,e){var n;if(window.attachEvent)for(n=0;n<this.length;n++)this[n].attachEvent("on"+t,e);else for(n=0;n<this.length;n++)this[n].addEventListener(t,e,!1);return this},w.prototype.unbind=function(t,e){var n;if(window.detachEvent)for(n=0;n<this.length;n++)this[n].detachEvent("on"+t,e);else for(n=0;n<this.length;n++)this[n].removeEventListener(t,e,!1);return this},w.prototype.position=function(t){var e=this[0].getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}};var g=function(t,e){var n,r,o=[];for(n=0;n<4;n++)for(r=0;r<e.length/4;r++)o[4*r+n]=t[n]*e[4*r]+t[n+4]*e[4*r+1]+t[n+8]*e[4*r+2]+t[n+12]*e[4*r+3];return o};return w.Matrix4=function(t){var p=t||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],c={move:function(t,e,n){return p=g([1,0,0,0,0,1,0,0,0,0,1,0,t,e,n,1],p),c},rotate:function(t,e,n,r,o,i,h){var s,u,a,f=function(t,e,n,r,o,i){if("number"!=typeof t||"number"!=typeof e)throw new Error("a1 and b1 is required!");if("number"!=typeof n?(n=0,r=t,o=e,i=1):"number"==typeof r&&"number"==typeof o&&"number"==typeof i||(r=t,o=e,i=n,n=e=t=0),t==r&&e==o&&n==i)throw new Error("It's not a legitimate ray!");var h=Math.sqrt((r-t)*(r-t)+(o-e)*(o-e)),s=0!=h?(o-e)/h:1,u=0!=h?(r-t)/h:0,a=(r-t)*u+(o-e)*s,f=i-n,l=Math.sqrt(a*a+f*f),p=0!=l?f/l:1,c=0!=l?a/l:0;return[[s,p*u,u*c,0,-u,s*p,s*c,0,0,-c,p,0,e*u-t*s,n*c-t*u*p-e*s*p,-t*u*c-e*s*c-n*p,1],[s,-u,0,0,p*u,p*s,-c,0,u*c,s*c,p,0,t,e,n,1]]}(e,n,r,o,i,h);return p=g(g(g(f[1],(s=t,u=Math.sin(s),[a=Math.cos(s),u,0,0,-u,a,0,0,0,0,1,0,0,0,0,1])),f[0]),p),c},scale:function(t,e,n,r,o,i){var h,s,u,a,f,l;return p=g([h=t,0,0,0,0,s=e,0,0,0,0,u=n,0,(a=r=r||0)-a*h,(f=o=o||0)-f*s,(l=i=i||0)-l*u,1],p),c},multiply:function(t,e){return p=e?g(p,t):g(t,p),c},use:function(t,e,n,r){var o=g(p,[t,e,n=n||0,r=r||1]);return o[0]=Math.round(1e14*o[0])/1e14,o[1]=Math.round(1e14*o[1])/1e14,o[2]=Math.round(1e14*o[2])/1e14,o},value:function(){return p}};return c},w.hermite=function(){var u={u:.5},a=function(t){if(u.MR){var e=(t-u.a)/(u.b-u.a),n=e*e;return(e*n*u.MR[0]+n*u.MR[1]+e*u.MR[2]+u.MR[3])*(u.b-u.a)}throw new Error("You shoud first set the position!")};return a.setU=function(t){if("number"!=typeof t)throw new Error("Expecting a figure!");return u.u=.5*(1-t),a},a.setP=function(t,e,n,r,o,i){if(!(t<n))throw new Error("The point position should be increamented!");u.a=t,u.b=n;var h=u.u*o,s=u.u*i;return e/=n-t,r/=n-t,u.MR=[2*e-2*r+h+s,3*r-3*e-2*h-s,h,e],a},a},w.cardinal=function(){var e,o={t:0},i=function(t){if(o.hs){for(e=-1;e+1<o.hs.x.length&&(t>o.hs.x[e+1]||-1==e&&t>=o.hs.x[e+1]);)e+=1;if(-1==e||e>=o.hs.h.length)throw new Error("Coordinate crossing!");return o.hs.h[e](t)}throw new Error("You shoud first set the position!")};return i.setU=function(t){if("number"!=typeof t)throw new Error("Expecting a figure!");return o.t=t,i},i.setP=function(t){o.hs={x:[],h:[]};var e,n,r=(t[1][1]-t[0][1])/(t[1][0]-t[0][0]);for(o.hs.x[0]=t[0][0],e=1;e<t.length;e++){if(t[e][0]<=t[e-1][0])throw new Error("The point position should be increamented!");o.hs.x[e]=t[e][0],n=e<t.length-1?(t[e+1][1]-t[e-1][1])/(t[e+1][0]-t[e-1][0]):(t[e][1]-t[e-1][1])/(t[e][0]-t[e-1][0]),o.hs.h[e-1]=w.hermite().setU(o.t).setP(t[e-1][0],t[e-1][1],t[e][0],t[e][1],r,n),r=n}return i},i},w.author="心叶",w.email="yelloxing@gmail.com",w.version="1.3.1",t.clay=t.$$=w,w});