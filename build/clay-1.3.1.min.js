/*!
*
* clay - Provide more flexible data visualization solutions!
* git+https://github.com/yelloxing/clay.git
* 
* author 心叶
*
* version 1.3.1
* 
* build Sun Jul 29 2018
*
* Copyright yelloxing
* Released under the MIT license
* 
* Date:Thu Nov 01 2018 00:04:10 GMT+0800 (CST)
*/

!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e(t):e(t)}("undefined"!=typeof window?window:this,function(t,c){"use strict";var v=function(t,e){return new v.prototype.init(t,e)};v.prototype.init=function(t,e){this.context=e=e||document;var n,r=s(t,e);for(n=0;n<r.length;n++)this[n]=r[n];return this.selector=t,this.length=r.length,this},v.prototype.init.prototype=v.prototype;var o={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},y={whitespace:"[\\x20\\t\\r\\n\\f]",identifier:"(?:\\\\.|[\\w-]|[^\0-\\xa0])+"},i=["href","title","show","type","role","actuate"];function s(t,e){var n,r=[];if("string"!=typeof t){if(!t||1!==t.nodeType&&11!==t.nodeType&&9!==t.nodeType){if(!t||t.constructor!==Array&&t.constructor!==HTMLCollection&&t.constructor!==NodeList)return t&&t.constructor===v?t:[];for(n=0;n<t.length;n++)!t[n]||1!==t[n].nodeType&&11!==t[n].nodeType&&9!==t[n].nodeType||r.push(t[n]);return r}return[t]}if("*"===(t=(t+"").trim().replace(/[\n\f\r]/g,"")))return e.getElementsByTagName("*");var i=y.whitespace,o=y.identifier,s="\\["+i+"{0,}"+o+"(?:"+i+"{0,}="+i+"{0,}(\\'|\\\"){0,1}"+o+"\\1{0,1}){0,1}"+i+"{0,}\\]";if(new RegExp("^(?:"+o+"){0,1}(?:(?:#|\\.)"+o+"|"+s+"){0,}$").test(t)){var h,a=t.match(new RegExp("#"+o,"g")),u=t.match(new RegExp("\\."+o,"g")),c=t.match(new RegExp("^"+o)),f=t.match(new RegExp(s,"g"));if(a){if(1<a.length)return[];h=(h=document.getElementById((a.shift(0)+"").replace(/^#/,"")))?[h]:[]}else h=e.getElementsByClassName&&u?e.getElementsByClassName((u.shift(0)+"").replace(/^\./,"")):c?e.getElementsByTagName(c.shift(0)):e.getElementsByTagName("*");var l,g,p,d,m=new RegExp("^\\["+i+"{0,}("+o+")(?:"+i+"{0,}="+i+"{0,}(?:\\'|\\\"){0,1}("+o+")(?:\\'|\\\"){0,1}){0,1}"+i+"{0,}\\]$");for(n=0;n<h.length;n++)if(d=!0,!(c&&0<c.length&&(c[0]+"").toUpperCase()!==(h[n].tagName+"").toUpperCase())){for(l=" "+h[n].getAttribute("class")+" ",g=0;d&&u&&g<u.length;g++)if(l.search(" "+(u[g]+"").replace(/\./,"")+" ")<0){d=!1;break}for(g=0;d&&f&&g<f.length;g++)if(l=m.exec(f[g]),null===(p=h[n].getAttribute(l[1]))||l[2]&&p!=l[2]){d=!1;break}d&&r.push(h[n])}return r}try{return[w(t)]}catch(t){return[]}}function w(t){var e=document.createElementNS(o.svg,"svg");new RegExp("^"+y.identifier+"$").test(t)&&(t="<"+t+"></"+t+">"),e.innerHTML=t;var n,r,i=e.childNodes;for(n=0;n<i.length;n++)if(1===i[n].nodeType||9===i[n].nodeType||11===i[n].nodeType){r=i[n];break}if("canvas"==r.tagName||/[A-Z]/.test(r.tagName))for((e=document.createElement("div")).innerHTML=t,i=e.childNodes,n=0;n<i.length;n++)if(1===i[n].nodeType||9===i[n].nodeType||11===i[n].nodeType){r=i[n];break}return r}v.prototype.find=function(t){if(this.length<=0)return v();var e,n=v(),r=s(t,this[0]);for(n.selector=t,e=0;e<r.length;e++)n[e]=r[e],n.length+=1;return n},v.prototype.eq=function(t){return this.length<=t?new v:new v(this[t])},v.prototype.appendTo=function(t){var e,n,r=v(t);for(e=0;e<r.length;e++)for(n=0;n<this.length;n++)r[e].appendChild(this[n]);return this},v.prototype.remove=function(){var t;for(t=0;t<this.length;t++)this[t].parentNode.removeChild(this[t]);return this},v.prototype.refresh=function(){var t,e=s(this.selector,this.context),n=this.length;for(t=this.length=0;t<e.length;t++)this[t]=e[t],this.length+=1;for(;t<n;t++)delete this[t];return this},v.prototype.attr=function(t,e){if(null==e||e==c)return 0<this.length?this[0].getAttribute(t):c;var n,r;for(n=0;n<this.length;n++)r="function"==typeof e?e(this[n]._data,n,this.eq(n)):e,/[A-Z]/.test(this[n].tagName)&&0<=i.indexOf(t)?this[n].setAttributeNS(o.xlink,"xlink:"+t,r):this[n].setAttribute(t,r);return this},v.prototype.css=function(t,e){if(arguments.length<=1&&"object"!=typeof t){if(this.length<1)return c;var n=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(this[0],null):this[0].currentStyle;return"string"==typeof t?n.getPropertyValue(t):n}var r,i;if(0<this.length)if("object"==typeof t)for(i in t)for(r=0;r<this.length;r++)this[r].style[i]="function"==typeof e?e(this[r]._data,r,i,t[i]):t[i];else for(r=0;r<this.length;r++)this[r].style[t]="function"==typeof e?e(this[r]._data,r):e;return this},v.prototype.datum=function(t,e){if(null===t||t===c)return 0<this.length?this[0]._data:c;var n;for(t="function"==typeof e?e(t):t,n=0;n<this.length;n++)this[n]._data=t;return this},v.prototype.data=function(t,e){var n,r=[];if(t&&t.constructor===Array){var i=v();for(i.selector=this.selector,n=0;n<t.length&&n<this.length;n++)this[n]._data="function"==typeof e?e(t[n]):t[n],i[n]=this[n],i.length+=1;for(i._enter=[];n<t.length;n++)i._enter.push("function"==typeof e?e(t[n]):t[n]);for(i._exit=[];n<this.length;n++)i._exit.push(this[n]);return i}for(n=0;n<this.length;n++)r[n]=this[n]._data;return r},v.prototype.enter=function(t){var e,n,r=v();for(r.selector=this.selector,e=0;this._enter&&e<this._enter.length;e++)(n=w(t))._data=this._enter[e],r[e]=n,r.length+=1;return delete this._enter,r},v.prototype.exit=function(){var t,e=v();for(e.selector=this.selector,t=0;this._exit&&t<this._exit.length;t++)e[t]=this._exit[t],e.length+=1;return delete this._exit,e},v.prototype.bind=function(t,e){var n;if(window.attachEvent)for(n=0;n<this.length;n++)this[n].attachEvent("on"+t,e);else for(n=0;n<this.length;n++)this[n].addEventListener(t,e,!1);return this},v.prototype.unbind=function(t,e){var n;if(window.detachEvent)for(n=0;n<this.length;n++)this[n].detachEvent("on"+t,e);else for(n=0;n<this.length;n++)this[n].removeEventListener(t,e,!1);return this},v.prototype.position=function(t){var e=this[0].getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}};var a={timers:[],interval:13,speeds:400,timerId:null};v.animation=function(e,t,n){a.timer(function(t){e(t)},t,n)},a.timer=function(t,e,n){if("function"!=typeof t)throw new Error("tick is required!");(e="number"==typeof e?e:a.speeds)<0&&(e=-e),a.timers.push({createTime:new Date,tick:t,duration:e,callback:n}),a.start()},a.start=function(){a.timerId||(a.timerId=setInterval(a.tick,a.interval))},a.tick=function(){var t,e,n,r,i,o,s,h=a.timers;for(a.timers=[],e=a.timers.length=0;e<h.length;e++)t=(i=h[e]).createTime,n=i.tick,o=i.duration,r=i.callback,!1,1<=(s=(+new Date-t)/o)&&!0,n(s=1<s?1:s),s<1?a.timers.push(i):r&&r();a.timers.length<=0&&a.stop()},a.stop=function(){a.timerId&&(clearInterval(a.timerId),a.timerId=null)},v.color=function(t){var e=v("head").css("color",t).css("color").replace(/^rgba?\(([^)]+)\)$/,"$1").split(new RegExp("\\,"+y.whitespace));return[+e[0],+e[1],+e[2],e[3]==c?1:+e[3]]},v.loop=function(t,e){var n,r=0;for(n in t)e(t[n],n,r++);return v};var f=function(t,e,n){t.beginPath(),t.fillStyle=e,n(t),t.fill()};function h(t){if(t&&t.constructor===CanvasRenderingContext2D)return t;var e=v(t);return 0<e.length?e[0].getContext("2d"):void 0}v.region=function(t,e,n){var i={},r=document.createElement("canvas"),o=[0,0,0],s="r";r.setAttribute("width",e),r.setAttribute("height",n);var h=v(t),a=r.getContext("2d"),u={drawer:function(t,e){return i[t]==c&&(i[t]={r:function(){return o[0]+=1,s="g","rgb("+o[0]+","+o[1]+","+o[2]+")"},g:function(){return o[1]+=1,s="b","rgb("+o[0]+","+o[1]+","+o[2]+")"},b:function(){return o[2]+=1,s="r","rgb("+o[0]+","+o[1]+","+o[2]+")"}}[s]()),f(a,i[t],e),u},erase:function(t){return f(a,"rgb(0,0,0)",t),u},getRegion:function(t){var e,n=h.position(t),r=a.getImageData(n.x-.5,n.y-.5,1,1).data;for(e in i)if("rgb("+r[0]+","+r[1]+","+r[2]+")"==i[e])return e;return c}};return u},v.prototype.canvas=function(){if(0<this.length&&"CANVAS"!=this[0].nodeName&&"canvas"!=this[0].nodeName)throw new Error("canvas is not function");return h(this)},v.prototype.layer=function(){if(0<this.length&&"CANVAS"!=this[0].nodeName&&"canvas"!=this[0].nodeName)throw new Error("layer is not function");var e=h(this),n=[],r={},i=this[0].clientWidth,o=this[0].clientHeight,s={get:function(t){return r[t]&&r[t].constructor===CanvasRenderingContext2D||(n.push(document.createElement("canvas")),n[n.length-1].setAttribute("width",i),n[n.length-1].setAttribute("height",o),r[t]=n[n.length-1].getContext("2d")),r[t]},clean:function(t){return t.clearRect(0,0,i,o),s},update:function(){if(e&&e.constructor===CanvasRenderingContext2D){var t;for(e.clearRect(0,0,i,o),e.save(),t=0;t<n.length;t++)e.drawImage(n[t],0,0,i,o,0,0,i,o);e.restore()}return s}};return s},v.prototype.webgl=function(t){if(0<this.length&&"CANVAS"!=this[0].nodeName&&"canvas"!=this[0].nodeName)throw new Error("Webgl is not a function!");return function(t,e){if(t&&t.constructor===WebGLRenderingContext)return t;var n,r=v(t),i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],o=null;if(0<r.length)for(n=0;n<i.length;n++){try{o=r[0].getContext(i[n],e)}catch(t){}if(o)break}return o}(this,t)};var p=function(t,e){var n,r,i=[];for(n=0;n<4;n++)for(r=0;r<e.length/4;r++)i[4*r+n]=t[n]*e[4*r]+t[n+4]*e[4*r+1]+t[n+8]*e[4*r+2]+t[n+12]*e[4*r+3];return i};v.Matrix4=function(t){var l=t||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],g={move:function(t,e,n,r){return l=p(function(t,e,n,r){r=r||0;var i=Math.sqrt(e*e+n*n+r*r);return[1,0,0,0,0,1,0,0,0,0,1,0,e*t/i,n*t/i,r*t/i,1]}(t,e,n,r),l),g},rotate:function(t,e,n,r,i,o,s){var h,a,u,c=function(t,e,n,r,i,o){if("number"!=typeof t||"number"!=typeof e)throw new Error("a1 and b1 is required!");if("number"!=typeof n?(n=0,r=t,i=e,o=1):"number"==typeof r&&"number"==typeof i&&"number"==typeof o||(r=t,i=e,o=n,n=e=t=0),t==r&&e==i&&n==o)throw new Error("It's not a legitimate ray!");var s=Math.sqrt((r-t)*(r-t)+(i-e)*(i-e)),h=0!=s?(i-e)/s:1,a=0!=s?(r-t)/s:0,u=(r-t)*a+(i-e)*h,c=o-n,f=Math.sqrt(u*u+c*c),l=0!=f?c/f:1,g=0!=f?u/f:0;return[[h,l*a,a*g,0,-a,h*l,h*g,0,0,-g,l,0,e*a-t*h,n*g-t*a*l-e*h*l,-t*a*g-e*h*g-n*l,1],[h,-a,0,0,l*a,l*h,-g,0,a*g,h*g,l,0,t,e,n,1]]}(e,n,r,i,o,s);return l=p(p(p(c[1],(h=t,a=Math.sin(h),[u=Math.cos(h),a,0,0,-a,u,0,0,0,0,1,0,0,0,0,1])),c[0]),l),g},scale:function(t,e,n,r,i,o){var s,h,a,u,c,f;return l=p([s=t,0,0,0,0,h=e,0,0,0,0,a=n,0,(u=(u=r)||0)-u*s,(c=(c=i)||0)-c*h,(f=(f=o)||0)-f*a,1],l),g},multiply:function(t,e){return l=e?p(l,t):p(t,l),g},use:function(t,e,n,r){var i=p(l,[t,e,n=n||0,r=r||1]);return i[0]=Math.round(1e14*i[0])/1e14,i[1]=Math.round(1e14*i[1])/1e14,i[2]=Math.round(1e14*i[2])/1e14,i},value:function(){return l}};return g},v.hermite=function(){var a={u:.5},u=function(t){if(a.MR){var e=(t-a.a)/(a.b-a.a),n=e*e;return(e*n*a.MR[0]+n*a.MR[1]+e*a.MR[2]+a.MR[3])*(a.b-a.a)}throw new Error("You shoud first set the position!")};return u.setU=function(t){if("number"!=typeof t)throw new Error("Expecting a figure!");return a.u=.5*(1-t),u},u.setP=function(t,e,n,r,i,o){if(!(t<n))throw new Error("The point position should be increamented!");a.a=t,a.b=n;var s=a.u*i,h=a.u*o;return e/=n-t,r/=n-t,a.MR=[2*e-2*r+s+h,3*r-3*e-2*s-h,s,e],u},u},v.cardinal=function(){var e,i={t:0},o=function(t){if(i.hs){for(e=-1;e+1<i.hs.x.length&&(t>i.hs.x[e+1]||-1==e&&t>=i.hs.x[e+1]);)e+=1;if(-1==e||e>=i.hs.h.length)throw new Error("Coordinate crossing!");return i.hs.h[e](t)}throw new Error("You shoud first set the position!")};return o.setU=function(t){if("number"!=typeof t)throw new Error("Expecting a figure!");return i.t=t,o},o.setP=function(t){i.hs={x:[],h:[]};var e,n,r=(t[1][1]-t[0][1])/(t[1][0]-t[0][0]);for(i.hs.x[0]=t[0][0],e=1;e<t.length;e++){if(t[e][0]<=t[e-1][0])throw new Error("The point position should be increamented!");i.hs.x[e]=t[e][0],n=e<t.length-1?(t[e+1][1]-t[e-1][1])/(t[e+1][0]-t[e-1][0]):(t[e][1]-t[e-1][1])/(t[e][0]-t[e-1][0]),i.hs.h[e-1]=v.hermite().setU(i.t).setP(t[e-1][0],t[e-1][1],t[e][0],t[e][1],r,n),r=n}return o},o};var m=function(t,e,n,r){var i=Math.cos(t),o=Math.sin(t);return[e*i-n*o,e*o+n*i,r]};return v.map=function(){var p,d={c:[107,36],s:1},n=function(t,e){var n,r,i,o,s,h,a,u,c,f,l,g;return n=(360-e)/180*Math.PI,r=100*d.s,o=i=0,s=Math.cos(n),h=Math.sin(n),p=[o*h+r*s,i,o*s-r*h],p=m(t/180*Math.PI,p[0],p[1],p[2]),p=m((90-d.c[0])/180*Math.PI,p[0],p[1],p[2]),a=(90-d.c[1])/180*Math.PI,u=p[0],c=p[1],f=p[2],l=Math.cos(a),g=Math.sin(a),[-(p=[u,c*l-f*g,c*g+f*l])[0],p[1],p[2]]};return n.scale=function(t){return"number"==typeof t&&(d.s=t),n},n.center=function(t,e){return"number"==typeof t&&"number"==typeof e&&(d.c=[t,e]),n},n},v.author="心叶",v.email="yelloxing@gmail.com",v.version="1.3.1",t.clay=t.$$=v,v});